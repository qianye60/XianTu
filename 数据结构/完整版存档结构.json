# 修仙游戏存档数据结构设计文档

## 总体设计原则

这是一个**完整的本地存档系统**，包含游戏世界的所有数据：玩家角色、NPC、物品、世界状态等。支持单机多存档和联机单存档两种模式。

## 完整数据结构

```json
{
  "当前激活存档": {
    "角色ID": "char_1001",
    "存档槽位": "存档1"
  },
  "角色列表": {
    "char_1001": {
      "模式": "单机",
      "角色基础信息": {
        "名字": "剑心",
        "世界": "凡人界",
        "天资": "天妒英才",
        "出生": "孤儿",
        "灵根": "天品金灵根",
        "天赋": ["剑道奇才", "过目不忘"],
        "先天六司": {
          "根骨": 8,
          "灵性": 7,
          "悟性": 10,
          "福缘": 5,
          "魅力": 6,
          "心性": 9
        }
      },
      "存档列表": {
        "存档1": {
          "存档名": "初入宗门",
          "保存时间": "2024-08-20T11:24:00",
          "游戏内时间": "元年一月三日 辰时",
          "世界地图": {
            "当前地图": "青云镇",
            "已探索区域": ["新手村", "青云镇", "后山"],
            "地图传送点": {
              "青云镇": {"坐标": {"X": 10, "Y": 50}, "已激活": true},
              "后山": {"坐标": {"X": 25, "Y": 80}, "已激活": false}
            },
            "地图事件": {
              "青云镇_神秘商人": {"触发状态": "已完成", "冷却时间": "三日后重置"}
            }
          },
          "存档数据": {
            "玩家角色状态": {
              "境界": 1,
              "声望": 10,
              "位置": {"描述": "青云镇", "坐标": {"X": 10, "Y": 50}},
              "气血": {"当前": 95, "最大": 100},
              "灵气": {"当前": 48, "最大": 50},
              "神识": {"当前": 20, "最大": 20},
              "寿命": {"当前": 16, "最大": 80},
              "状态效果": ["吃下了练气丹，体内灵气涌动", "轻微擦伤"]
            },
            "装备栏": {
              "武器": "item_uuid_f8a3",
              "防具": null,
              "法宝1": null,
              "法宝2": null,
              "饰品": null,
              "坐骑": null
            },
            "功法技能": {
              "主修功法": "skill_uuid_c110",
              "已学技能": ["skill_uuid_b205", "skill_uuid_a101"],
              "技能熟练度": {
                "skill_uuid_b205": {"等级": 3, "经验": 1200}
              }
            },
            "背包": {
              "灵石": {"下品": 100, "中品": 5, "上品": 1, "极品": 0},
              "物品": {
                "item_uuid_f8a3": {
                  "名称": "新手飞剑",
                  "类型": "法宝",
                  "品质": {"阶位": "凡", "品级": 1},
                  "装备增幅": {
                    "气血上限": 0,
                    "灵气上限": 10,
                    "神识上限": 5,
                    "后天六司": {"根骨": 0, "灵性": 0.05, "悟性": 0, "福缘": 0, "魅力": 0, "心性": 0}
                  },
                  "装备特效": ["赶路时速度增加5%", "战斗中先攻值+1"],
                  "数量": 1,
                  "耐久度": {"当前": 95, "最大": 100}
                },
                "item_uuid_d5b9": {
                  "名称": "练气丹",
                  "类型": "丹药",
                  "品质": {"阶位": "黄", "品级": 3},
                  "使用效果": "恢复100点灵气",
                  "数量": 10
                }
              }
            },
            "人物关系": {
                "婉儿": {
                    "角色基础信息": {
                    "名字": "婉儿",
                    "世界": "凡人界", 
                    "天资": "天生丽质",
                    "出生": "客栈老板女儿",
                    "灵根": "地品木灵根",
                    "天赋": ["治疗天赋"],
                    "先天六司": {"根骨": 5, "灵性": 6, "悟性": 7, "福缘": 8, "魅力": 9, "心性": 6}
                    },
                    "角色存档信息": {
                    "时间": "11:24",
                    "装备": {"1": null, "2": "item_c001", "3": null, "4": null, "5": null, "6": null},
                    "功法": {"主修功法": null, "已学技能": []},
                    "状态": [],
                    "境界": 1,
                    "声望": 5,
                    "位置": {"描述": "青云镇客栈", "坐标": {"X": 35.2156, "Y": 108.8426}},
                    "当前气血": 80, "最大气血": 80,
                    "当前灵气": 40, "最大灵气": 40,
                    "当前神识": 15, "最大神识": 15,
                    "当前寿命": 18, "最大寿命": 120,
                    "背包": {
                        "灵石": {"下品": 50, "中品": 2, "上品": 0, "极品": 0},
                        "物品": [
                        {
                            "物品名称": "素色长裙",
                            "物品类型": 1,
                            "品质": {"品质": "凡", "品级": 2},
                            "装备增幅": {"后天六司": {"魅力": 1}},
                            "装备特效": [],
                            "物品ID": "item_c001"
                        }
                        ]
                    }
                    },
                    "AI行为": {
                    "行为模式": "友善NPC",
                    "日常路线": [
                        {"时间": "辰时", "位置": "客栈后厨", "行为": "准备早餐"},
                        {"时间": "巳时", "位置": "客栈大堂", "行为": "招待客人"}, 
                        {"时间": "酉时", "位置": "客栈房间", "行为": "休息"}
                    ]
                    },
                    "人物关系": "友好",
                    "人物好感度": 10,
                    "人物记忆": ["第一次见到主角，他踩着飞剑，有点帅", "他帮我打扫了客栈，是个好人"],
                    "互动次数": 3,
                    "最后互动时间": "元年一月二日 午时",
                    "特殊标记": []
                },
                "青云真人": {
                    "角色基础信息": {
                    "名字": "青云真人",
                    "世界": "凡人界",
                    "天资": "道法天成", 
                    "出生": "青云宗掌门",
                    "灵根": "天品风雷灵根",
                    "天赋": ["剑道宗师", "领导才能"],
                    "先天六司": {"根骨": 9, "灵性": 10, "悟性": 9, "福缘": 8, "魅力": 8, "心性": 10}
                    },
                    "角色存档信息": {
                    "时间": "11:24",
                    "装备": {"1": "legendary_sword", "2": "master_robe", "3": "wind_pearl", "4": null, "5": null, "6": "cloud_beast"},
                    "功法": {"主修功法": "qingyun_supreme", "已学技能": ["sword_mastery", "wind_control", "thunder_strike"]},
                    "状态": ["修为深不可测"],
                    "境界": 7,
                    "声望": 8000,
                    "位置": {"描述": "青云宗主殿", "坐标": {"X": 35.9, "Y": 109.1}},
                    "当前气血": 5000, "最大气血": 5000,
                    "当前灵气": 8000, "最大灵气": 8000,
                    "当前神识": 6000, "最大神识": 6000,
                    "当前寿命": 500, "最大寿命": 1500,
                    "背包": {
                        "灵石": {"下品": 10000, "中品": 1000, "上品": 100, "极品": 10},
                        "物品": []
                    }
                    },
                    "AI行为": {
                    "行为模式": "威严长辈",
                    "日常路线": [
                        {"时间": "卯时", "位置": "主殿", "行为": "晨练功法"},
                        {"时间": "辰时", "位置": "议事厅", "行为": "处理宗门事务"},
                        {"时间": "午时", "位置": "后山", "行为": "指导弟子"},
                        {"时间": "酉时", "位置": "主殿", "行为": "修炼静心"}
                    ]
                    },
                    "人物关系": "长辈",
                    "人物好感度": 0,
                    "人物记忆": ["这个年轻人刚入门，需要观察"],
                    "互动次数": 0,
                    "最后互动时间": null,
                    "特殊标记": ["宗门掌门", "剑道宗师"]
                }
            }

          }
        },
        "存档2": {"存档名": "空", "保存时间": null, "存档数据": null},
        "存档3": {"存档名": "空", "保存时间": null, "存档数据": null}
      }
    },
    "char_1002": {
      "模式": "联机",
      "角色基础信息": {
        "名字": "道玄",
        "世界": "凡人界",
        "天资": "大气运者",
        "出生": "修仙世家",
        "灵根": "天品水灵根",
        "天赋": ["丹道圣手", "亲和光环"],
        "先天六司": {"根骨": 7, "灵性": 9, "悟性": 8, "福缘": 10, "魅力": 8, "心性": 7}
      },
      "存档": {
        "云端同步信息": {
          "最后同步": "2024-08-20T14:00:00",
          "版本": 15,
          "需要同步": false
        },
        "存档数据": {
          "玩家角色状态": {},
          "装备栏": {},
          "功法技能": {},
          "背包": {},
        }
      }
    }
  }
}
