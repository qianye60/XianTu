  /**
   * 增强的世界生成提示词系统
   * 解决势力重复、命名固化、规模不合理等问题
   * 支持不同修仙世界背景适配
   */
  
  export interface WorldPromptConfig {
    factionCount: number;
    totalLocations: number;
    secretRealms: number;
    characterBackground?: string;
    worldBackground?: string;
    worldEra?: string;
    worldName?: string;
  }
  
  export class EnhancedWorldPromptBuilder {
    static buildPrompt(config: WorldPromptConfig): string {
      
      // 使用用户配置的精确数量，不添加随机变化避免数量失控
      // 严格按照配置值生成，确保AI看到的数字是正确的
      const finalFactionCount = config.factionCount;
      const finalLocationCount = config.totalLocations; 
      const finalSecretRealmCount = Math.min(config.secretRealms, finalLocationCount); // 特殊属性不能超过总地点数
      
      // 删除固定的势力分级限制，让AI自然生成有影响力的大势力
      
      // 动态计算地点分布
      const headquarters = finalFactionCount; // 每个势力一个总部
      const remainingLocations = finalLocationCount - headquarters;
      const cities = Math.floor(remainingLocations * (0.2 + Math.random() * 0.3)); // 20%-50%
      const specialSites = Math.floor(remainingLocations * (0.15 + Math.random() * 0.25)); // 15%-40%
      const dangerZones = Math.floor(remainingLocations * (0.1 + Math.random() * 0.2)); // 10%-30%
      const otherSites = Math.max(0, remainingLocations - cities - specialSites - dangerZones);
      
      // 动态计算特殊属性分布
      const opportunityRealms = Math.floor(finalSecretRealmCount * (0.3 + Math.random() * 0.3)); // 30%-60%
      const heritageRealms = Math.floor(finalSecretRealmCount * (0.2 + Math.random() * 0.3)); // 20%-50%
      const dangerousRealms = Math.max(0, finalSecretRealmCount - opportunityRealms - heritageRealms);
      
      const backgroundInfo = config.characterBackground ? 
        `\n角色出身: ${config.characterBackground}` : '';
      
      
      // 世界背景信息
      const worldBackgroundInfo = config.worldBackground ? 
        `\n世界背景: ${config.worldBackground}` : '';
      const worldEraInfo = config.worldEra ? 
        `\n世界时代: ${config.worldEra}` : '';
      const worldNameInfo = config.worldName ? 
        `\n世界名称: ${config.worldName}` : '';
  
      // 生成真正随机的坐标范围 - 每次生成都不同
      const baseMinLng = 100 + Math.random() * 20;  // 100-120 范围随机选择基础经度
      const baseMaxLng = baseMinLng + 5 + Math.random() * 10; // 基础经度 + 5-15 度
      const baseMinLat = 25 + Math.random() * 15;  // 25-40 范围随机选择基础纬度  
      const baseMaxLat = baseMinLat + 3 + Math.random() * 8; // 基础纬度 + 3-11 度
      
      // 四舍五入到一位小数，便于阅读
      const minLng = Math.round(baseMinLng * 10) / 10;
      const maxLng = Math.round(baseMaxLng * 10) / 10;
      const minLat = Math.round(baseMinLat * 10) / 10;
      const maxLat = Math.round(baseMaxLat * 10) / 10;
  
      // 生成唯一的随机种子确保每次都不同
      const uniqueSeed = Date.now() + Math.floor(Math.random() * 1000000);
      const sessionId = Math.random().toString(36).substring(7);
      
      // 生成大洲形状变化指导
      const continentShapes = [
        '狭长型（如南北向的长条形）',
        '椭圆型（东西向的宽椭圆）',
        '不规则多角形（8-12个随机分布的顶点）',
        '群岛型（多个连接的岛屿）',
        '半月型（弯曲的月牙形状）',
        '三角形（大致呈三角形分布）',
        '葫芦型（两个圆形区域连接）',
        '星形（从中心向外延伸的多个尖角）'
      ];
      
      // 随机选择几种形状用于不同大洲
      const selectedShapes = continentShapes.sort(() => Math.random() - 0.5).slice(0, 4);
  
      // 调试日志
      console.log('[增强世界生成器] 最终数量 - 势力:', finalFactionCount, '地点:', finalLocationCount, '特殊属性:', finalSecretRealmCount);
      console.log('[增强世界生成器] 随机坐标范围:', `经度${minLng}-${maxLng}, 纬度${minLat}-${maxLat}`);
      console.log('[增强世界生成器] 生成种子:', uniqueSeed, '会话ID:', sessionId);
      console.log('[增强世界生成器] 选择的大洲形状:', selectedShapes);
  
      return `
  # 诸天万界势力地图生成任务
  
  **生成会话ID**: ${sessionId}
  **随机种子**: ${uniqueSeed}
  **坐标范围**: 经度${minLng}-${maxLng}, 纬度${minLat}-${maxLat}
  **关键要求**: 创造独特多样的修仙世界，每次生成必须显著不同，避免重复固化的势力和地名
  **边界随机性**: 严格要求每个大洲和势力的边界形状都必须随机生成，绝不能重复之前的多边形形状！
  **数量限制**: 严格按照配置生成，势力${finalFactionCount}个、地点${finalLocationCount}个，绝不可超出此数量
  
  ## ⚠️ 绝对禁止的内容 - 严格执行
  **禁止生成以下任何名称或相似变体**:
  - 太上忘情道、血影楼、万法归元宗、听风陆氏、四海通宝阁
  - 太素道宫、问剑崖、万魂幡、东方世家、四海通会
  - 任何包含"太上"、"万法"、"四海"、"血影"等固定词汇的组合
  
  **强制创新要求**:
  - 每个势力名称必须独创，不得使用任何常见的修仙小说套路名称
  - 宗门名称必须体现独特的文化背景和修炼理念  
  - 绝对不允许生成任何曾经出现过的势力名称
  - 使用随机种子${uniqueSeed}确保完全不同的创意方向
  - 必须使用以下命名策略确保唯一性：
    * 方位类：融合独特地理特征（如：寒霜峡、赤炎岭、碧海潮音）
    * 理念类：体现修炼哲学（如：虚无归一、万象更新、道心不变）
    * 传承类：展现历史底蕴（如：远古遗承、九代相传、千年道统）
    * 神秘类：富含玄幻色彩（如：星辰秘典、混元造化、太虚幻境）
  
  ## 世界设定信息
  ${backgroundInfo}${worldBackgroundInfo}${worldEraInfo}${worldNameInfo}
  
  ## 🎯 核心生成原则
  
  ### 1. 【修仙世界基础】
  
  核心要求：
  - **核心体系**: 修仙、境界、功法、丹药、法宝等传统修仙元素
  - **权力结构**: 强者为尊的修仙世界等级秩序
  
  ### 2. 【多样性第一】- 避免固化模式
  - **势力多样化**: 每次生成不同类型的势力组合，避免总是"青云宗、天剑门、万花谷"等重复名称
  - **地名创新**: 完全避免使用模板化地名，每个名称都要有特色且独一无二
  - **规模平衡**: 修仙世界中宗门为主，但要根据背景调整表现形式
  
  ### 3. 【势力规模】- 符合修仙体系设定
  根据修仙世界的基本规律和世界背景调整势力分布：
  
  **修仙世界的合理势力分布**:
  - 🏔️ **各大宗门** (40-50%): 修仙世界的主体势力
  - 🏛️ **修仙世家** (20-30%): 血脉传承，底蕴深厚
  - ⚔️ **魔道势力** (10-20%): 与正道对立的黑暗力量
  - 🏮 **散修联盟** (10-15%): 自由修士的松散组织
  - 💰 **商会组织** (5-15%): 贸易流通，中立势力
  - 🌿 **妖族部落** (5-10%): 非人种族，自然势力
  
  **重要**: 根据世界背景调整具体表现形式，但保持修仙体系的核心！
  
  ## 🌍 地理层级结构
  
  ### 大洲级别区域
  为了营造更宏大的世界观，需要创造6-11个大洲级别的地理区域来包裹各个势力：
  
  **大洲创造要求**：
  - **数量控制**: 必须创造6-11个大洲，增加板块数量，让世界更丰富复杂
  - **命名创新**: 创造独特的大洲名称，避免使用"东西南北"等方位词
  - **地理特色**: 每个大洲要有独特的地理特征（如：雪域、沙漠、森林、海岛等）
  - **势力分布**: 由于大洲增多，每个大洲包含1-2个主要势力，形成更细致的地缘政治格局
  - **边界设计**: 大洲边界用中型多边形表示（8-15个坐标点），让更多大洲能够合理分布
  - **紧密分布**: 🔥**关键要求**🔥 大洲之间必须紧密相邻，几乎无缝连接，形成完整连贯的世界地图
  - **屏障设置**: 大洲之间的天然屏障（山脉、海峡、瘴气、结界等）应该是狭窄的分界线，而不是大片空白区域
  - **🚫 重叠禁令**: 绝对禁止大陆边界重叠！但要求边界尽可能接近，形成紧密贴合的拼图效果
  
  **本次大洲形状指导**（每个大洲选择不同的形状类型）:
  ${selectedShapes.map((shape, index) => `- 大洲${index + 1}: ${shape}`).join('\n')}
  
  **重要**: 每次生成时，每个大洲的边界形状都必须有显著差异，不能生成相似的多边形！
  
  ## 🧩 **自然分布策略 - 避免重叠**
  
  **合理空间分布原则**：
  1. **自然分隔**: 大陆之间保持0.3-0.8度的自然间隔（约30-80公里），代表海洋、虚空或天然屏障
  2. **分散布局**: 6-11个大陆应该分散分布在整个坐标空间，总覆盖率控制在60-75%
  3. **留白美学**: 大陆之间的空白区域可以是海洋、禁区、虚空等，增加世界的神秘感
  4. **简洁边界**: 每个大陆边界使用6-10个坐标点，形成自然但不过于复杂的形状
  
  **智能分布技术**：
  - 采用"群岛式"分布：大陆如同海洋中的岛屿，相互独立但有航路连接
  - 形成"星座式"连接：大陆如同夜空中的星座，有明确的空间关系但保持距离
  - 使用"网格化"布局：将坐标空间分为若干区域，每个区域放置1-2个大陆
  - 确保"清晰边界"：每个大陆都有明确独立的边界，不与其他大陆接触
  
  ## 🔍 **重叠防止与验证机制**
  
  **三重保障机制**：
  1. **边界安全距离**: 每个大陆边界与其他大陆保持最少0.3度的安全距离
  2. **区域独占验证**: 每个大陆占据独立的空间区域，不与其他大陆区域交叉
  3. **势力包含检查**: 势力范围必须完全在其所属大陆内部，不能跨越大陆边界
  
  **分层空间管理**：
  - 第一层：大陆板块（大尺度地理单元，跨度2-4度）
  - 第二层：势力范围（中等尺度，跨度0.3-1.0度，必须在大陆内部）
  - 第三层：具体地点（小尺度点状分布，必须在势力范围或大陆内）
  
  ## 🚨 **大陆与势力分布规范**
  
  **空间层级要求**：
  1. **大陆规模**: 每个大陆跨度2-4度，作为主要地理单元
  2. **势力规模**: 每个势力跨度0.3-1.0度，显著小于所在大陆
  3. **间隔要求**: 
     - 大陆之间：最少0.3度间隔
     - 势力之间：最少0.1度间隔（同一大陆内）
     - 势力与大陆边界：最少0.1度内缩
  4. **分布密度**: 
     - 每个大陆包含1-3个主要势力
     - 大陆覆盖率：总空间的60-75%
     - 势力覆盖率：所在大陆的30-60%
     - 相邻大陆的凸出部分要与另一大陆的凹入部分完美衔接
     - 形成有机的、自然的边界形状，避免规则几何分布
     - 大陆间仅以极细的自然分界线分隔（狭窄海峡、山脊线、河谷等）
  5. **空间填充验证**: 确保6-11个大陆总计覆盖坐标范围的95%以上区域，相邻边界距离不超过0.02度
  
  **大洲示例风格**：
  - 传统修仙：如"青霞大陆"、"紫薇星域"、"九天玄境"
  - 都市修仙：如"东亚修仙区"、"欧洲灵能带"、"美洲觉醒地带"
  - 神话古典：如"太古神域"、"洪荒大地"、"混沌边疆"
  
  ## 📊 本次生成参数 (严格按照配置)
  - **势力总数**: 必须精确生成${finalFactionCount}个势力，不多不少
  - **地点总数**: 必须精确生成${finalLocationCount}个地点，不多不少  
  - **特殊属性**: 从${finalLocationCount}个地点中选择${finalSecretRealmCount}个添加特殊属性
  
  **重要**: factions数组必须包含${finalFactionCount}个对象，locations数组必须包含${finalLocationCount}个对象！
  
  ### 🏛️ 势力生成要求 (${finalFactionCount}个) - 完整组织架构
  
  **宗门完整数据结构要求**:
  每个宗门势力都必须生成完整的组织架构信息，包括：
  
  **1. 基础信息**:
  - 宗门名称、类型、等级（超级/一流/二流/三流）
  - 宗门等级以一流/二流/三流/末流区分（不需要数值化实力）
  - 宗门描述和历史背景
  - 宗门特色和专长（必须是数组格式）
  
  **2. 领导层信息** (leadership字段) - **必须完整生成，前端会直接显示**:
  \`\`\`json
  "leadership": {
    "宗主": "具体姓名（必填，如：李青云）",
    "宗主修为": "具体境界（必填，如：化神中期、元婴后期等）",
    "副宗主": "姓名（可选，如：王明月）", 
    "长老数量": 具体数字（必填，如：15），
    "最强修为": "宗门内最高修为境界（必填，如：化神大圆满）",
    "综合战力": 数字1-100（必填，如：85），
    "核心弟子数": 具体数字（必填，如：50），
    "内门弟子数": 具体数字（必填，如：300），
    "外门弟子数": 具体数字（必填，如：1200）
  }
  \`\`\`
  
  **⚠️ 重要：leadership字段是前端显示的核心数据，绝对不能省略或留空！**
  
  **3. 成员统计信息** (memberCount字段) - **必须完整生成，前端宗门页面会显示**:
  \`\`\`json
  "memberCount": {
    "total": 总人数（必填数字，如：1565），
    "byRealm": {
      "练气": 数量（必填，如：800），
      "筑基": 数量（必填，如：400）， 
      "金丹": 数量（必填，如：200），
      "元婴": 数量（必填，如：100），
      "化神": 数量（必填，如：50），
      "炼虚": 数量（必填，如：10），
      "合体": 数量（必填，如：4），
      "大乘": 数量（必填，如：1），
      "渡劫": 数量（必填，如：0），
      "真仙": 数量（必填，如：0）
    },
    "byPosition": {
      "散修": 0,
      "外门弟子": 数量（必填，如：1200），
      "内门弟子": 数量（必填，如：300），
      "核心弟子": 数量（必填，如：50），
      "传承弟子": 数量（必填，如：10），
      "执事": 数量（必填，如：20），
      "长老": 数量（必填，如：15），
      "副掌门": 数量（必填，如：1），
      "掌门": 1
    }
  }
  \`\`\`
  
  **⚠️ 数据一致性要求：**
  - memberCount.total 必须等于 byPosition 所有职位的总和
  - byRealm 各境界总和必须等于 total
  - 所有数值必须是数字类型，不能是字符串
  - **前端会根据这些数据显示境界分布图表和成员统计！**
  
  **4. 修为境界与宗门等级对应关系**:
  - **超级宗门**: 宗主最低化神期，拥有炼虚期长老，总人数2000-5000
  - **一流宗门**: 宗主最低元婴期，拥有化神期长老，总人数1000-3000  
  - **二流宗门**: 宗主最低金丹期，拥有元婴期长老，总人数500-1500
  - **三流宗门**: 宗主最低筑基后期，拥有金丹期长老，总人数200-800
  
  **修仙宗门势力命名原则**:
  - 🎋 **传统古韵**: 使用具有古典韵味的字词组合，如："青霞宗"、"太虚门"、"天机院"、"无极宫"
  - 📿 **意境深远**: 体现修仙追求，如："悟道派"、"问心殿"、"见性庵"、"归一教"
  - ⚗️ **专长特色**: 结合势力专长，如："炼器堂"、"符箓阁"、"灵丹谷"、"剑修盟"
  - 🌌 **自然元素**: 融入山水天象，如："流云宗"、"沧海门"、"紫薇院"、"昊天派"
  - 🚫 **严禁使用**: 绝对禁止使用法宝、道具类名称作为宗门名，如不能使用"万魂帆"、"九转金丹"、"太乙神针"等物品名称

  **正确命名示例**:
  ✅ 宗门类："紫霄宗"、"太玄门"、"无量观"、"天机阁"
  ✅ 世家类："司马世家"、"上官氏族"、"东方名门"、"诸葛一脉"  
  ✅ 联盟类："散修联盟"、"自由修士会"、"天南盟"、"北域联合"
  ❌ 错误示例："万魂帆宗"、"九转金丹门"、"太乙神针派"（这些是法宝名，不是宗门名）

  **数据结构完整性要求** - **前端势力宗门页面依赖以下数据**:
  每个宗门势力必须包含完整的数据结构，绝不能有空值或缺失字段：
  
  1. **基础字段**（必填，不能为空）:
     - 名称: 具体的宗门名称（如："青霞仙宗"）
     - 类型: 明确的宗门类型（如："修仙宗门"）
     - 等级: 超级/一流/二流/三流之一
     - 描述: 详细的背景描述，至少100字
     - 特色: 数组格式，至少2个特色（如：["剑道传承", "炼器工艺"]）
     - 与玩家关系: "中立"（初始状态）
     - 声望值: 0（初始状态，程序会计算）
     - 位置: 具体坐标对象

  2. **组织架构**（必填，不能为空，前端会在"宗门领导"部分显示）:
     - 宗主: 具体姓名（必填，如："李青云"）
     - 宗主修为: 具体境界（必填，如："化神中期"）
     - 副宗主: 姓名或null（如："王明月"或null）
     - 长老数量: 具体数字（必填，如：15）
     - 最强修为: 境界（必填，如："化神大圆满"）
     - 综合战力: 1-100数字（必填，如：85）
     - 核心弟子数: 具体数字（必填，如：50）
     - 内门弟子数: 具体数字（必填，如：300）
     - 外门弟子数: 具体数字（必填，如：1200）

  3. **成员统计**（必填，不能为空，前端会在"成员统计"部分显示图表）:
     - total: 总人数（必填数字，如：1565）
     - byRealm: 各境界人数统计（练气、筑基、金丹、元婴、化神、炼虚、合体、大乘、渡劫、真仙）
     - byPosition: 各职位人数统计（散修:0、外门弟子、内门弟子、核心弟子、传承弟子、执事、长老、副掌门、掌门:1）

  **🎯 前端显示说明**:
  - 势力宗门页面会直接读取这些字段进行显示
  - 缺少任何字段都会导致页面显示异常
  - 宗主、长老数量、境界分布等信息是用户最关心的内容
  - 成员统计数据会生成可视化图表

  **数据一致性验证**:
  - memberCount.total 必须等于 byPosition 所有职位的总和
  - leadership.宗主修为 不能低于 memberCount.byRealm 中的最高境界
  - 仅依据宗门等级（几流）体现实力层级，无需数值评分
  - 所有数值字段都必须是数字类型，不能是字符串
  
  **势力实力等级原则**:
  修仙世界的宗门势力应该按照严格的等级体系划分：
  
  - 🏔️ **超级宗门** (95-100分): 1-2个，统治一方的霸主级势力，拥有化神期以上强者
  - ⭐ **一流宗门** (85-94分): 2-3个，实力雄厚的顶级宗门，拥有元婴期强者坐镇  
  - 🔥 **二流宗门** (70-84分): 3-4个，有一定影响力的知名宗门，拥有金丹期强者
  - 📿 **三流宗门** (60-69分): 其余宗门，地方性小宗门，主要以筑基期修士为主
  - 💫 **修仙世家** (65-90分): 血脉传承，实力跨度较大，但底蕴深厚
  - ⚡ **魔道势力** (70-95分): 实力强劲但行事诡异，与正道对立
  
  **重要**: 避免全部生成相同等级的势力，应该形成金字塔结构！
  
  **势力规模控制 - 宗门应小于大洲**:
  - 🌍 **大洲范围**: 每个大洲边界跨度3-6度，为主要地理单元
  - 🏛️ **宗门势力**: 每个宗门势力范围应为0.3-1.2度，明显小于大洲
  - 📏 **尺寸比例**: 宗门势力面积不应超过所在大洲的20%，保持合理的规模层级
  - 🎯 **空间分布**: 一个大洲内可容纳2-4个宗门势力，避免单个势力独霸整个大洲
  1. **背景适配**: 所有势力类型必须符合修仙本质
  2. **避免重复**: 绝对不能生成相同或相似的势力名称
  3. **风格统一**: 采用符合世界背景的命名风格
  4. **修仙核心**: 所有势力都要有修仙体系相关的专长和特色
  5. **实力体现**: 作为知名势力，实力应该体现其影响力和地位
  6. **势力边界**: 每个势力必须有territory_bounds定义其控制范围，生成**小而精致**的边界形状：
     - 大势力：4-5个坐标点，形成**紧凑**的多边形（边界范围约0.8-1.2度）
     - 中等势力：3-4个坐标点，形成**小型规整**的三四边形（边界范围约0.5-0.8度）  
     - 小势力：3个坐标点，形成**精简小巧**的三角形（边界范围约0.3-0.6度）
     - **🔑 关键要求**：宗门势力范围要**显著小于大洲**，让大洲成为更宏大的地理概念
     - **📐 尺寸对比**：如果大洲边界跨度3-6度，那么宗门势力应该只有0.3-1.2度
     - **🎨 形状优化**：优先生成圆形、椭圆形、矩形等规整形状，体现宗门的有序管理
  
  ### 🗺️ 地点生成要求 (${finalLocationCount}个)
  
  **地点分布**:
  - 🏯 **势力总部**: ${headquarters}个 (对应各势力)
  - 🏘️ **城镇坊市**: ${cities}个
  - ⚡ **特殊地点**: ${specialSites}个
  - ⚠️ **危险区域**: ${dangerZones}个
  - 🌄 **自然景观**: ${otherSites}个
  
  **地点类型** (必须使用以下7种标准类型):
  1. **natural_landmark** - 🏔️ 自然地标 (符合背景的自然景观)
  2. **sect_power** - 🏯 势力总部 (各修仙势力的总部)
  3. **city_town** - 🏘️ 城镇聚居地 (符合背景风格的城镇)  
  4. **blessed_land** - ⛩️ 修炼圣地 (适合修仙的灵气充沛之地)
  5. **treasure_land** - 💎 资源宝地 (天材地宝、灵石矿脉等)
  6. **dangerous_area** - ⚔️ 危险区域 (凶兽巢穴、魔域险地等)
  7. **special_other** - 🌟 特殊地点 (传送阵、秘境入口等)
  
  ### ✨ 特殊属性增强 (${finalSecretRealmCount}个地点)
  
  从基础地点中选择${finalSecretRealmCount}个添加特殊属性:
  - 🎯 **机遇之地**: ${opportunityRealms}个
  - 📜 **传承遗迹**: ${heritageRealms}个  
  - ☠️ **危险禁地**: ${dangerousRealms}个
  
  ## 🎨 创新变化要求
  
  **每次生成必须不同**:
  1. **势力组合**: 不同的势力类型搭配
  2. **命名风格**: 变化命名的文化背景和风格特色
  3. **地理布局**: 不同的势力分布模式
  4. **专长重点**: 相同类型势力也要有不同的专长侧重
  5. **冲突关系**: 各势力间的恩怨情仇要有变化
  6. **⭐ 边界形状**: 每个大洲和势力的边界形状都必须完全不同，使用以下随机化策略：
     - 随机选择顶点数量（8-15个顶点）
     - 随机分布顶点位置（不要规律排列）
     - 根据指定的形状类型生成对应的边界
     - 每个坐标点都要在指定范围内随机选择，不要固定数值
     - 同一世界内的不同大洲边界形状差异要非常明显
  
  **⚠️ 反重复检查机制**:
  - 生成前必须确认没有使用禁止列表中的任何名称
  - 势力名称不得包含常见的修仙网文套路词汇
  - 每个势力的特色和专长必须独特，避免雷同
  - 实力分布要有层次，不能全部势力实力相近
  
  **重要**: 使用随机种子 ${uniqueSeed} 来确保所有随机选择都是不同的！
  
  ## 📋 JSON输出格式 (严格数量控制)
  
  **数量检查清单**:
  - ✅ continents数组包含6-11个大洲对象，彼此边界不重叠
  - ✅ factions数组包含${finalFactionCount}个势力对象
  - ✅ locations数组包含${finalLocationCount}个地点对象
  - ✅ 其中${finalSecretRealmCount}个地点有special_attributes
  - ✅ 每个势力都分配到某个大洲
  
  **重要提醒**: 
  - factions数组必须恰好包含${finalFactionCount}个元素，locations数组必须恰好包含${finalLocationCount}个元素！
  - 大陆边界绝对不能重叠，必须相互独立且保持安全距离
  
  \`\`\`json
  {
    "world_name": "${config.worldName || '修仙界'}",
    "world_background": "${config.worldBackground || ''}",
    "world_era": "${config.worldEra || ''}",
    "generation_info": {
      "session_id": "${sessionId}",
      "seed": ${uniqueSeed},
      "world_type": "修仙世界",
      "generation_notes": "本次生成的独特特色和创新点"
    },
    "player_spawn": {
      "note": "本版本已移除玩家出生地生成功能"
    },
    "continents": [
      {
        "id": "continent_1",
        "name": "大洲名称",
        "description": "大洲地理特征和文化描述",
        "climate": "气候类型",
        "terrain_features": ["主要地貌特征"],
        "natural_barriers": ["与其他大洲的天然屏障"],
        "continent_bounds": [
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}}
        ],
        "dominant_factions": ["在此大洲的主要势力ID列表"]
      }
    ],
    "factions": [
      {
        "id": "faction_1", 
        "名称": "势力名称",
        "类型": "势力类型（修仙宗门/修仙世家/魔道势力等）",
        "等级": "宗门等级（超级/一流/二流/三流）",
        "描述": "势力背景描述，体现独特文化",
        "特色": ["独特专长1", "独特专长2"],
        
        "与玩家关系": "中立",
        "声望值": "程序自动计算，无需填写",
        "位置": {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
        "势力范围": [
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
          {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}}
        ],
        "leadership": {
          "宗主": "具体姓名（必填，如：李青云）",
          "宗主修为": "具体境界（必填，如：化神中期、元婴后期等）",
          "副宗主": "姓名（可选，如：王明月或null）",
          "长老数量": 具体数字（必填，如：15），
          "最强修为": "宗门内最高修为境界（必填，如：化神大圆满）",
          "综合战力": 数字1-100（必填，如：85），
          "核心弟子数": 具体数字（必填，如：50），
          "内门弟子数": 具体数字（必填，如：300），
          "外门弟子数": 具体数字（必填，如：1200）
        },
        "memberCount": {
          "total": 总人数（必填数字，如：1565），
          "byRealm": {
            "练气": 数量（必填，如：800），
            "筑基": 数量（必填，如：400）， 
            "金丹": 数量（必填，如：200），
            "元婴": 数量（必填，如：100），
            "化神": 数量（必填，如：50），
            "炼虚": 数量（必填，如：10），
            "合体": 数量（必填，如：4），
            "大乘": 数量（必填，如：1），
            "渡劫": 数量（必填，如：0），
            "真仙": 数量（必填，如：0）
          },
          "byPosition": {
            "散修": 0,
            "外门弟子": 数量（必填，如：1200），
            "内门弟子": 数量（必填，如：300），
            "核心弟子": 数量（必填，如：50），
            "传承弟子": 数量（必填，如：10），
            "执事": 数量（必填，如：20），
            "长老": 数量（必填，如：15），
            "副掌门": 数量（必填，如：1），
            "掌门": 1
          }
        },
        "continent_id": "所属大洲的ID"
      }
    ],
    "locations": [
      {
        "id": "loc_1",
        "name": "地点名称",
        "type": "7种标准类型之一",
        "coordinates": {"longitude": ${minLng}-${maxLng}, "latitude": ${minLat}-${maxLat}},
        "description": "地点详细描述", 
        "danger_level": "安全/普通/危险/极危险",
        "suitable_for": ["适合群体"],
        "controlled_by": "控制势力(可选)",
        "special_features": ["地点特色"],
        "special_attributes": ["特殊属性(可选)"]
      }
    ]
  }
  \`\`\`
  
  ## ⚠️ 最终检查要求
  - ✅ 避免重复或相似的势力/地点名称
  - ✅ 保持修仙体系核心，强者为尊
  - ✅ 势力类型和专长符合修仙背景
  - ✅ JSON格式完整，坐标在指定范围内 (经度${minLng}-${maxLng}，纬度${minLat}-${maxLat})
  - ✅ **必须生成完整的leadership字段** - 包含宗主、宗主修为、长老数量、最强修为、弟子数量等
  - ✅ **必须生成完整的memberCount字段** - 包含total、byRealm、byPosition等完整统计信息
  - ✅ **数据类型正确** - 所有数量字段必须是数字，不能是字符串
  - ✅ **数据一致性** - memberCount.total必须等于byPosition各职位总和

  **🚨 前端显示依赖警告：**
  势力宗门页面会直接使用leadership和memberCount字段显示宗门信息！
  缺少这些字段将导致页面显示"暂无宗门信息"！
  
  **核心目标**: 创造一个独一无二的修仙世界，包含完整的宗门组织架构信息！
  `;
    }
  }
