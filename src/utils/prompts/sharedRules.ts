/**
 * @file Shared AI Prompt Rules (共享提示词规则)
 * @description 核心规则集，跨文件复用，减少token重复
 */

/**
 * 数据同步铁律 (Data Sync Rules)
 */
export const CORE_SYNC_RULES = `
# 🔴 数据同步铁律 (Data Sync Rule | 最高优先级)

⚠️ text写什么 → commands执行什么 (违反=崩溃)

**检查清单**：
- 修炼? → 时间+进度+灵气+功法
- 突破? → 境界+阶段+进度+上限+寿命(add)
- 受伤? → 气血-
- 获得物品? → set 背包.物品.{物品ID} (修改具体物品，不是整个背包)
- 消耗物品? → set 背包.物品.{物品ID}.数量 或 delete 背包.物品.{物品ID}
- NPC互动? → push记忆+好感±+状态+内心
- 位置移动? → 描述+经纬度

**重要原则**：
✅ 修改具体字段路径，如 "背包.物品.sword_001.数量"
✅ 使用 add/set 修改单个属性值
❌ 不要用 set 替换整个对象（如整个"背包"、整个"装备栏"）
❌ text有变化但commands=[]

**正确示例**：
- 获得1把剑 → {"action":"set","key":"背包.物品.sword_001","value":{完整物品对象}}
- 消耗1颗丹药 → {"action":"add","key":"背包.物品.pill_001.数量","value":-1}
- 增加好感度 → {"action":"add","key":"人物关系.张三.好感度","value":5}

**错误示例**：
❌ {"action":"set","key":"背包","value":{整个背包对象}}
❌ {"action":"set","key":"装备栏","value":{整个装备栏对象}}
`;

/**
 * 境界阶段命名 (Realm Stage Naming)
 */
export const REALM_STAGE_RULE = `
⚠️ 境界阶段 (Realm Stage)：
✅ 初期/中期/后期/圆满/极境
❌ 一层/二层/一重/第X层
凡人无阶段("")，炼气+用标准名`;

/**
 * JSON格式规则 (JSON Format Rules)
 */
export const JSON_RULES = `
## JSON规则
- 无注释(//, /**/)、无尾逗号
- 双引号、字段加引号、无前导0
- null代替undefined
- 小写true/false`;

/**
 * 六司系统 (Attribute System)
 */
export const INNATE_ATTRIBUTES_RULE = `
⚠️ 六司系统 (Attributes)：
- **先天六司** (Innate)：天生，永不可改
- **后天六司** (Acquired)：装备/大道，可变
- 最终 = 先天×100% + 后天×20%
- 修改：{"action":"add","key":"基础信息.后天六司.根骨","value":1}`;

/**
 * 角色私密信息生成规则 (v4.0 - 字段精准匹配)
 */
export const NSFW_RULE = `
# 🎭 角色私密信息生成规则 (最高优先级 | 必须执行)

⚠️ **强制要求**: 当 \`系统.nsfwMode\` 为 \`true\` 时，你 **必须** 为符合 \`系统.nsfwGenderFilter\` 的 **所有NPC** 生成完整的 \`私密信息\` 对象。

🔴 **严禁跳过**: 不得以任何理由跳过、简化或省略私密信息的生成。这是强制性要求，违反将导致生成失败。

## 1. 生成时机
- **🔴 创建NPC时**: 必须立即生成完整的 \`私密信息\` 对象，不得遗漏任何字段
- **后续更新**: 可更新动态字段(性渴望/性状态等)

## 2. 🔴 必填字段(缺一不可)
\`私密信息\` 必须包含所有字段:

**核心字段**:
- \`是否为处女/处男\`: boolean (女性必填处女,男性必填处男)
- \`身体部位\`: Array (🔴必须3-5个,含部位名称/开发度/敏感度/特征描述/特殊印记)
- \`性格倾向\`: "纯情"|"主动"|"被动"|"淫荡"|"M"|"S"|"双性"
- \`性取向\`: "异性恋"|"同性恋"|"双性恋"|"泛性恋"
- \`性癖好\`: Array (0-3个)
- \`性渴望程度\`: number (0-100)
- \`当前性状态\`: "正常"|"微湿"|"兴奋"|"发情"|"高潮"
- \`体液分泌状态\`: string
- \`性交总次数\`: number
- \`性伴侣数量\`: number
- \`性伴侣名单\`: Array<string> (禁用"保密""未知"占位符)
- \`最近一次性行为时间\`: string
- \`特殊体质\`: Array

## 3. 逻辑约束
- 数值0-100范围
- 处女=true → 次数=0,伴侣数=0,名单=[]
- 伴侣数=名单.length

## 4. 叙事整合
- 行为对话与私密信息一致(性格倾向/性渴望)
- 好感<60拒绝亲密,违反底线→好感暴跌
- 亲密门槛:好感≥60或性渴望≥70,纯情需≥80

🔴 **最后强调**: nsfwMode=true时,创建任何NPC都必须包含完整私密信息,这是强制要求不可省略!
`;

/**
 * 操作类型速查 (Action Types)
 */
export const ACTION_TYPES = `
## 操作类型 (Actions)
| Action | 用途 | 示例 |
|--------|------|------|
| set | 替换 | 境界、物品、NPC |
| add | 增减 | 灵石±、时间+ |
| push | 数组+ | 记忆、状态 |
| delete | 删除字段 | 物品(最后1个) |
| pull | 数组- | 删除任务(匹配对象) |`;