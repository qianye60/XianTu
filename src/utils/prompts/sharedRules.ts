/**
 * @fileoverview Shared rules for AI prompts to ensure consistency.
 *
 * 【职责】
 * - 定义所有提示词共用的核心规则，如JSON输出、NSFW内容生成、境界系统、玩家与NPC数据差异等。
 *
 * 【设计原则】
 * - 高度可复用，成为规则的“单一事实来源”。
 * - 单一职责，只包含规则定义。
 */

export const JSON_RULES = `
# 规则：JSON输出格式 (最高优先级)

1.  **必须输出纯JSON对象**：你的最终输出必须是一个完整的、语法正确的JSON对象。
2.  **禁止Markdown代码块**：严禁使用 \`\`\`json ... \`\`\` 包裹JSON输出。
    - ✅ 正确: {"key": "value"}
    - ❌ 错误: \`\`\`json {"key": "value"} \`\`\`
3.  **双引号规则**：所有的键(key)和字符串值(string value)都必须使用双引号 " "。
4.  **禁止尾随逗号**：在对象或数组的最后一项后面，绝对不能有逗号。
`.trim();

export const NSFW_RULE = `
# 规则：NSFW内容生成

当 \`系统.nsfwMode\` 为 \`true\` 时，必须严格遵守以下规则：

## 1. NPC私密信息（完整结构）

- **触发条件**：创建NPC时，若 \`nsfwMode=true\` 且NPC性别符合 \`nsfwGenderFilter\`("all"|"female"|"male")，则必须生成完整的\`私密信息\`对象。
- **存储位置**：\`人物关系.{NPC名字}.私密信息\`
- **字段完整性**：\`私密信息\`对象必须包含所有13个必填字段，缺一不可。
- **逻辑一致性**：
  - \`是否为处女/处男=true\` 必须对应 \`性交总次数=0\`, \`性伴侣数量=0\`, \`性伴侣名单=[]\`
  - \`性伴侣数量\` 必须等于 \`性伴侣名单.length\`
- **身体部位结构铁律**：身体部位必须是一个对象数组，每个对象都必须包含：\`部位名称\`, \`开发度\`, \`敏感度\`, \`特征描述\`, \`特殊印记\`。

## 2. 玩家身体部位开发（NSFW专属 - 极简结构）

- **触发条件**：角色初始化时，若 \`nsfwMode=true\`，必须为玩家生成3-5个**私密敏感部位**。
- **存储位置**：\`身体部位开发\` (SaveData根级别字段)
- **数据结构**：\`{"部位名": {"特征描述": "..."}}\`
- **部位类型**：仅限NSFW私密部位，如：胸部、乳头、小穴、菊穴、阴蒂等性敏感区域
- **重要提醒**：
  - ❌ 玩家不使用 \`玩家角色状态.私密信息\` 字段
  - ✅ 玩家只使用 \`身体部位开发\` 字段
  - ❌ 不要生成普通身体部位，这是NSFW专属的私密内容
`.trim();

export const REALM_STAGE_RULE = `
# 规则：境界与阶段

1.  **境界顺序**：凡人 → 炼气 → 筑基 → 金丹 → 元婴 → 化神 → 炼虚 → 合体 → 渡劫。
2.  **阶段划分**：每个境界分为初期、中期、后期、圆满、极境(罕见)。
3.  **属性提升**：境界突破时，必须用 \`add\` 增加气血、灵气、神识的上限。
`.trim();

export const PLAYER_NPC_DIFFERENCES_RULE = `
# 规则：玩家与NPC数据结构差异

**核心要求：NPC的境界对象只有2个字段**
\`\`\`json
{"名称": "金丹", "阶段": "中期"}
\`\`\`

**严禁操作：** 不得为NPC添加以下玩家专属字段：
- \`当前进度\`
- \`下一级所需\`
- \`突破描述\`
- 任何其他额外字段
`.trim();
