/**
 * @fileoverview 核心输出规则 v2.0
 * @version 2.0.0
 * @lastUpdated 2025-12-01
 *
 * 【职责】
 * - JSON输出格式规范
 * - 响应格式要求
 * - 数据结构严格性规则
 * - AI感知游戏状态的核心约束
 *
 * 【设计原则】
 * - 最高优先级规则
 * - 技术性约束
 * - 确保系统正常运行
 * - 保证数据与叙事同步
 */

export const JSON_OUTPUT_RULES = `
# 输出格式规范（最高优先级）

## 🚨 输出顺序（铁律）
按顺序输出五个标签：
1. \`<thinking>\` - 思维链分析（必填）
2. \`<narrative>\` - 叙事文本（必填）
3. \`<memory>\` - 事件摘要（必填）
4. \`<commands>\` - 数据指令（必填）
5. \`<options>\` - 行动选项（必填）

## 📝 完整输出模板

<thinking>
## 1. 意图解析
- 用户输入: [原文]
- 核心意图: [提炼]

## 2. 场景感知
- 当前位置: [读取]
- 场景是否变化: [是/否]

## 3. 数据同步清单
□ 位置变化 → set
□ 时间流逝 → add
□ NPC互动 → push记忆 + add好感度
</thinking>

<narrative>
[1500-2500字叙事文本，纯小说风格，五感描写，禁止包含数值/属性等游戏数据]
</narrative>

<memory>
[50-100字事件摘要，客观第三人称]
</memory>

<commands>
[数据更新指令，每行一条，格式：操作|路径|值]
set|人物关系.某NPC.当前外貌状态|身着白衣，面带微笑
set|人物关系.某NPC.当前内心想法|此人气质不凡，值得结交
push|人物关系.某NPC.记忆|【仙历1050年4月】初次相遇，印象良好
add|人物关系.某NPC.好感度|5
add|游戏时间.分钟|30
</commands>

<options>
[3-5个行动选项，每行一个]
继续与对方交谈
告辞离开此地
询问对方来历
邀请对方同行
观察周围环境
</options>

## 📋 指令格式说明
每条指令格式：\`操作|路径|值\`
- **set**: 设置/覆盖值，如 \`set|玩家角色状态.位置|{"描述":"青云宗·广场","x":5000,"y":5000}\`
- **add**: 数值增减，如 \`add|背包.灵石.下品|100\` 或 \`add|气血.当前|-50\`
- **push**: 向数组添加，如 \`push|人物关系.某NPC.记忆|【时间】事件\`
- **delete**: 删除字段，如 \`delete|背包.物品.item_001|\`

## ⚠️ 注意事项
- 五个标签**全部必填**，缺一不可
- \`<thinking>\` 必须包含意图解析和数据同步清单
- \`<narrative>\` 内禁止出现任何游戏数据（数值、属性、进度等）
- \`<commands>\` 中的值如果是对象/数组，使用JSON格式
- \`<options>\` 禁止为空，必须有3-5个选项
`.trim()

export const RESPONSE_FORMAT_RULES = `
# 数据同步铁律
**text写了什么，tavern_commands就必须更新什么！**

## 同步检查表
| 描写内容 | 必须更新 |
|---------|---------|
| 场景变化 | set 玩家角色状态.位置 {描述,x,y} |
| 时间流逝 | add 游戏时间.分钟 |
| NPC出场 | set 当前外貌状态/当前内心想法 |
| NPC互动 | push 记忆 + add 好感度 |
| 战斗受伤 | add 气血.当前(负) + push 状态效果 |
| 使用技能 | add 灵气.当前(负) |
| 修炼进度 | add 境界.当前进度 |
| 物品变化 | set/delete 背包.物品 |
| 灵石变化 | add 背包.灵石.品级 |
`.trim()

export const DATA_STRUCTURE_STRICTNESS = `
# 数据结构规则

## 只读字段（禁止修改）
装备栏、修炼功法、掌握技能、记忆、系统、角色基础信息、年龄

## 境界更新
- 小突破: add 当前进度
- 大突破: set 整个境界对象

## NPC创建
必须一次性创建完整对象，禁止分步添加字段
`.trim()
