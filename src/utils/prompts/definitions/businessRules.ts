/**
 * @fileoverview 游戏业务逻辑规则
 *
 * 【职责】
 * - 境界系统规则
 * - 三千大道体系规则
 * - 玩家意图与判定系统
 * - NPC相关规则
 * - NSFW内容生成规则
 *
 * 【设计原则】
 * - 游戏玩法相关
 * - 业务逻辑约束
 * - 内容生成规范
 */

export const REALM_SYSTEM_RULES = `
# 规则：境界与阶段

1.  **境界顺序**：凡人 → 炼气 → 筑基 → 金丹 → 元婴 → 化神 → 炼虚 → 合体 → 渡劫。
2.  **阶段划分**：每个境界分为初期、中期、后期、圆满、极境(罕见)。
3.  **属性提升**：境界突破时，必须用 \`add\` 增加气血、灵气、神识的上限。
`.trim()

export const THREE_THOUSAND_DAOS_RULES = `
# 规则：三千大道体系

## 核心概念
- "三千大道"是辅助修炼体系，记录玩家领悟的各种道路（如剑道、丹道、武道等）。
- "境界"（炼气、筑基等）是主修的仙道进度。
- 境界是主修，大道是辅修感悟，两者相辅相成。

## 数据结构与指令规则
- **解锁大道**: 必须使用 \`set\` 指令，并设置 \`"是否解锁": true\`。
- **阶段列表**: \`阶段列表\` 必须是包含至少2个阶段对象的数组。
- **阶段对象**: 每个阶段对象必须包含 \`名称\`, \`描述\`, \`所需进度\` 字段。
- **进度更新**: 使用 \`add\` 指令增加 \`当前进度\`。
- **示例结构**:
  \`\`\`json
  "剑道": {
    "是否解锁": true,
    "当前阶段": "初窥门径",
    "当前进度": 0,
    "阶段列表": [
      {"名称": "初窥门径", "描述": "...", "所需进度": 100},
      {"名称": "小有所成", "描述": "...", "所需进度": 500},
      ...
    ]
  }
  \`\`\`
`.trim()

export const NPC_RULES = `
# 规则：NPC相关规则

## 1. 玩家与NPC数据结构差异
**核心要求：** NPC的境界对象只有 \`名称\` 和 \`阶段\` 2个字段。
**严禁操作：** 不得为NPC添加 \`当前进度\`, \`下一级所需\`, \`突破描述\` 等玩家专属字段。

## 2. NPC记忆更新
**核心规则：** 每次与NPC交互（对话、战斗、赠礼等），或NPC在场景中出现/被提及，都必须用 \`push\` 操作为其添加一条新的记忆。
**记忆格式：** \`"【游戏时间】10-30字中文事件描述"\`
**记忆内容要求：**
- 必须包含游戏时间（年月日）。
- 必须记录关键事件、对话内容、情感变化、以及对玩家的印象变化。

## 3. NPC关系动态更新（重要）
**核心规则：** NPC的 \`与玩家关系\` 和 \`好感度\` 必须根据互动内容实时更新，不能一直停留在初始状态。

**更新时机：**
- 每次对话、互动、赠礼、战斗后，必须评估是否需要更新关系和好感度
- 关系发生实质性变化时（从陌生到熟悉、从中立到友好/敌对等），必须及时更新关系描述
- 发生重大事件（结拜、成为道侣、师徒关系等）时，必须立即更新

**操作方式：**
- 好感度：使用 \`add\` 操作增减，如 \`{"action":"add","key":"人物关系.张三.好感度","value":10}\`
- 关系描述：使用 \`set\` 操作更新，如 \`{"action":"set","key":"人物关系.张三.与玩家关系","value":"朋友"}\`
`.trim()

export const NSFW_CONTENT_RULES = `
# 规则：NSFW内容生成

当 \`系统.nsfwMode\` 为 \`true\` 时，必须严格遵守以下规则：

## 1. NPC私密信息（完整结构）

- 触发条件：创建NPC时，若 \`nsfwMode=true\` 且NPC性别符合 \`nsfwGenderFilter\`("all"|"female"|"male")，则必须生成完整的\`私密信息\`对象
- 存储位置：\`人物关系.{NPC名字}.私密信息\`
- 字段完整性：\`私密信息\`对象必须包含所有12个必填字段，缺一不可
- 逻辑一致性：\`是否为处女/处男=true\` 必须对应 \`性交总次数=0\`, \`性伴侣名单=[]\`
- 身体部位结构：身体部位必须是对象数组，每个对象包含 \`部位名称\`, \`开发度\`, \`敏感度\`, \`特征描述\`, \`特殊印记\` 五个字段
- 性伴侣名单规则：
  - 必须使用具体人名：["张三", "李四", "王五"]
  - 已故或失踪在人名后注明：["张三(已故)", "李四(失踪)"]
  - 空数组表示无性伴侣：[]

## 2. 玩家身体部位开发（NSFW专属）

- 触发条件：角色初始化时，若 \`nsfwMode=true\`，必须为玩家生成3-5个私密敏感部位
- 存储位置：\`身体部位开发\` (SaveData根级别字段)
- 数据结构：\`{"部位名": {"特征描述": "..."}}\`
- 部位类型：仅限NSFW私密部位，如：胸部、乳头、小穴、菊穴、阴蒂等性敏感区域
- 重要：玩家只使用 \`身体部位开发\` 字段，不使用 \`玩家角色状态.私密信息\` 字段
`.trim()
