/**
 * @fileoverview 游戏业务逻辑规则
 *
 * 【职责】
 * - 境界系统规则
 * - 三千大道体系规则
 * - 玩家意图与判定系统
 * - NPC相关规则
 * - NSFW内容生成规则
 *
 * 【设计原则】
 * - 游戏玩法相关
 * - 业务逻辑约束
 * - 内容生成规范
 */

export const REALM_SYSTEM_RULES = `
# 规则：境界与阶段

1.  **境界顺序**：凡人 → 炼气 → 筑基 → 金丹 → 元婴 → 化神 → 炼虚 → 合体 → 渡劫。
2.  **阶段划分**：每个境界分为初期、中期、后期、圆满、极境(罕见)。
3.  **属性提升**：境界突破时，必须用 \`add\` 增加气血、灵气、神识的上限。
`.trim()

export const THREE_THOUSAND_DAOS_RULES = `
# 规则：三千大道体系（世界观核心）

## 大道归一的世界观
游戏名为《大道朝天》，核心理念是"三千大道，殊途同归"。无论是仙道、武道、佛道、魔道、儒道、科技之道，还是任何其他修炼体系，都是通往终极真理的不同路径，统一归入"大道"的概念中。

## 三千大道的包容性（各世界修炼体系）
- 仙道修炼：炼气、筑基、金丹、元婴等传统修仙境界
- 武道修炼：炼体、内劲、罡气、武意等武学体系
- 佛道修炼：禅定、明心、见性、涅槃等佛门修行
- 魔道修炼：血炼、魔化、魔体、魔神等魔道法门
- 科技之道：基因改造、机械飞升、数据永生等科技路线
- 儒道修炼：浩然正气、文气凝实、圣人之道
- 妖道修炼：化形、妖丹、妖王、妖圣等妖族体系
- 鬼道修炼：阴魂、鬼将、鬼王、鬼帝等幽冥体系
- 其他专精：符箓、阵法、炼丹、炼器、御兽、音律、医道等

## 境界与大道的关系
- 境界系统：玩家的"境界"字段（炼气、筑基等）代表主修的仙道进度，这是主线修炼体系
- 大道系统：玩家的"三千大道"字段记录所有领悟的道路进度，这是辅助修炼体系
- 互不冲突：境界是主修，大道是辅修感悟，两者相辅相成，不会互相干扰
- 融会贯通：不同大道之间可以互相借鉴，武道的体魄强化可以辅助仙道修炼，科技的理性思维可以帮助理解阵法原理

## AI生成内容时的注意事项
1. 世界设定：生成世界时，可以包含多种修炼体系并存的设定（如仙武同修的世界、科技与修真结合的世界）
2. NPC设定：NPC可以修炼不同的道路，不局限于传统仙道（如武道宗师、科技改造人、佛门高僧）
3. 功法生成：功法可以是武学秘籍、科技手册、佛门经文等，不限于仙道功法
4. 术语适配：根据世界观和修炼体系使用对应术语
   - 仙道：灵气、真元、神识、法力
   - 武道：内力、真气、罡气、武意
   - 科技：能量、生物能、精神力、电能
   - 佛道：佛力、禅定、慧根、舍利
   - 魔道：魔气、血气、煞气、魔念

## 示例场景
- 玩家主修仙道（境界：筑基期），同时领悟了剑道、炼丹之道、阵法之道
- 玩家在科幻世界中，主修科技体系（境界：基因改造二阶），同时领悟了机械之道、数据之道
- 玩家遇到武道高手，通过切磋领悟武道，将武道的体魄锻炼融入仙道修炼中
- 玩家进入佛门圣地，感悟佛法，领悟慈悲之道，用于化解心魔
`.trim()

export const PLAYER_INTENT_AND_JUDGMENT_RULES = `
# 规则：玩家意图与行动执行（绝对最高优先级）

## 🔴 核心铁律（必须严格遵守）

### 1. 用户输入至高无上
- **用户输入 = 最高指令**：用户输入的内容是最高优先级指令，任何其他规则都不得与之冲突
- **严格按字面意思执行**：必须按照用户输入的字面意思执行，不得曲解、不得改变、不得延伸
- **用户意图不可违背**：任何叙述、任何状态变更都必须围绕用户输入来展开

### 2. 严禁自作主张（核心约束）
- **不得擅自添加行动**：不得添加用户未明确要求的任何行动或剧情
- **不得突发事件打断**：不得用突发事件、意外情况打断或改变用户的行动意图
- **不得替玩家做决定**：只能描述行动结果（成功/失败/部分成功），绝不能替玩家选择下一步行动
- **不得擅自扩展剧情**：叙述必须紧扣用户输入，不得无故延伸到用户未提及的内容

### 3. 不合理要求的处理
- **境界/资源/技能不足**：必须判定失败，并说明原因。
- **违背规则**：必须拒绝执行，并说明原因。
- **模糊要求**：优先按字面意思执行。

## 判定系统
**重要：骰点由系统提供**
- 用户输入中会包含【系统骰点】信息，格式为：本回合骰点: X (1d20)
- 你必须使用系统提供的骰点值，不要自己生成随机数。
- 骰点范围1-20。

**判定规则**：
- 骰点20：完美成功（必定成功且有额外奖励）。
- 骰点1：大失败倾向（如果最终值仍未达标则为大失败，达标则为普通成功）。
- 其他骰点：根据最终值与难度比较判定成功/失败。

**判定格式**（严格遵守）：\`〖判定名称:结果,骰点:X,属性:X,加成:X,最终值:X,难度:X〗\`
- **判定名称**：直接写具体判定类型（如"灵气感知"、"炼器判定"），不要加"系统判定:"等前缀。
`.trim()

export const NPC_RULES = `
# 规则：NPC相关规则

## 1. 玩家与NPC数据结构差异
**核心要求：** NPC的境界对象只有 \`名称\` 和 \`阶段\` 2个字段。
**严禁操作：** 不得为NPC添加 \`当前进度\`, \`下一级所需\`, \`突破描述\` 等玩家专属字段。

## 2. NPC记忆更新
**核心规则：** 每次与NPC交互（对话、战斗、赠礼等），或NPC在场景中出现/被提及，都必须用 \`push\` 操作为其添加一条新的记忆。
**记忆格式：** \`"【游戏时间】10-30字中文事件描述"\`
**记忆内容要求：**
- 必须包含游戏时间（年月日）。
- 必须记录关键事件、对话内容、情感变化、以及对玩家的印象变化。
`.trim()

export const NSFW_CONTENT_RULES = `
# 规则：NSFW内容生成

当 \`系统.nsfwMode\` 为 \`true\` 时，必须严格遵守以下规则：

## 1. NPC私密信息（完整结构）

- 触发条件：创建NPC时，若 \`nsfwMode=true\` 且NPC性别符合 \`nsfwGenderFilter\`("all"|"female"|"male")，则必须生成完整的\`私密信息\`对象
- 存储位置：\`人物关系.{NPC名字}.私密信息\`
- 字段完整性：\`私密信息\`对象必须包含所有12个必填字段，缺一不可
- 逻辑一致性：\`是否为处女/处男=true\` 必须对应 \`性交总次数=0\`, \`性伴侣名单=[]\`
- 身体部位结构：身体部位必须是对象数组，每个对象包含 \`部位名称\`, \`开发度\`, \`敏感度\`, \`特征描述\`, \`特殊印记\` 五个字段
- 性伴侣名单规则：
  - 必须使用具体人名：["张三", "李四", "王五"]
  - 已故或失踪在人名后注明：["张三(已故)", "李四(失踪)"]
  - 空数组表示无性伴侣：[]

## 2. 玩家身体部位开发（NSFW专属）

- 触发条件：角色初始化时，若 \`nsfwMode=true\`，必须为玩家生成3-5个私密敏感部位
- 存储位置：\`身体部位开发\` (SaveData根级别字段)
- 数据结构：\`{"部位名": {"特征描述": "..."}}\`
- 部位类型：仅限NSFW私密部位，如：胸部、乳头、小穴、菊穴、阴蒂等性敏感区域
- 重要：玩家只使用 \`身体部位开发\` 字段，不使用 \`玩家角色状态.私密信息\` 字段
`.trim()