/**
 * @fileoverview 游戏业务逻辑规则
 *
 * 【职责】
 * - 境界系统规则
 * - 三千大道体系规则
 * - 玩家意图与判定系统
 * - NPC相关规则
 * - NSFW内容生成规则
 *
 * 【设计原则】
 * - 游戏玩法相关
 * - 业务逻辑约束
 * - 内容生成规范
 */

export const REALM_SYSTEM_RULES = `
# 规则：境界与阶段

**境界顺序**：凡人 → 炼气 → 筑基 → 金丹 → 元婴 → 化神 → 炼虚 → 合体 → 渡劫
**阶段划分**：初期、中期、后期、圆满、极境(罕见)

## 突破经验标准（必须遵守）

**小阶段突破**：初期→中期(基础×1)、中期→后期(×2)、后期→圆满(×3)、圆满→极境(×10)

**各境界基础值**：炼气1000、筑基5000、金丹20000、元婴100000、化神500000、炼虚2000000、合体10000000、渡劫50000000

**大境界突破**：炼气→筑基10000、筑基→金丹50000、金丹→元婴200000、元婴→化神1000000、化神→炼虚5000000、炼虚→合体20000000、合体→渡劫100000000

## 重要规则
- 突破到新阶段时"当前进度"重置为0
- 大境界突破必须同时增加气血、灵气、神识上限
- 极境突破需特殊机缘
`.trim()

export const THREE_THOUSAND_DAOS_RULES = `
# 规则：三千大道体系

## 核心概念
- "三千大道"是辅助修炼体系，记录玩家领悟的各种道路（如剑道、丹道、武道等）。
- "境界"（炼气、筑基等）是主修的仙道进度。
- 境界是主修，大道是辅修感悟，两者相辅相成。

## 数据结构与指令规则
- **解锁大道**: 必须使用 \`set\` 指令，并设置 \`"是否解锁": true\`。
- **阶段列表**: \`阶段列表\` 必须是包含至少2个阶段对象的数组。
- **阶段对象**: 每个阶段对象必须包含 \`名称\`, \`描述\`, \`突破经验\` 字段。
- **进度更新**: 使用 \`add\` 指令增加 \`当前经验\`。
- **示例结构**:
  \`\`\`json
  "剑道": {
    "道名": "剑道",
    "描述": "以剑入道，追求剑之极致",
    "是否解锁": true,
    "当前阶段": 0,
    "当前经验": 0,
    "总经验": 0,
    "阶段列表": [
      {"名称": "初窥门径", "描述": "...", "突破经验": 100},
      {"名称": "小有所成", "描述": "...", "突破经验": 500},
      ...
    ]
  }
  \`\`\`
`.trim()

export const NPC_RULES = `
# 规则：NPC相关规则

## 1. 数据结构差异
NPC境界只有\`名称\`和\`阶段\`2个字段，严禁添加\`当前进度\`等玩家专属字段

## 2. 记忆更新
每次交互必须用\`push\`添加记忆，格式：\`"【游戏时间】10-30字事件描述"\`

## 3. 关系动态更新
\`与玩家关系\`和\`好感度\`必须根据互动实时更新，不能停留在初始状态
- 好感度：\`{"action":"add","key":"人物关系.张三.好感度","value":10}\`
- 关系：\`{"action":"set","key":"人物关系.张三.与玩家关系","value":"朋友"}\`

## 4. 物品配置
根据身份、境界、职业合理配置背包：
- 普通NPC：少量灵石，1-2件凡品/黄品
- 修士NPC：适量灵石，2-4件物品（功法、丹药、材料）
- 商人/长老：大量灵石和高品质物品
`.trim()

export const SKILL_AND_SPELL_USAGE_RULES = `
# 规则：技能、法术、神通使用与消耗

## 🔴 核心强制规则
**任何使用修行手段的行为，都必须消耗对应的修行状态！**

### 适用范围（必须消耗）
- ✅ 使用掌握的技能（如御剑术、炼丹术）
- ✅ 施展法术、术法（如火球术、冰封术）
- ✅ 动用神通、秘术（如遁术、幻术）
- ✅ 使用法宝、灵器的特殊能力
- ✅ 施展阵法、符咒
- ✅ 任何需要调动灵气或神识的修行行为

### 不需要消耗的情况
- ❌ 普通物理攻击（拳脚、兵器）
- ❌ 日常对话、移动
- ❌ 被动天赋效果
- ❌ 装备提供的常驻加成
`.trim()

export const COMMAND_PATH_CONSTRUCTION_RULES = `
# 规则：命令路径构建

## 三大原则
1. **逐层连接**：\`顶层字段.子字段.目标字段\`（如\`玩家角色状态.境界.当前进度\`）
2. **动态拼接**：\`人物关系.[NPC名].好感度\` → \`人物关系.张三.好感度\`
3. **数组访问**：索引访问\`状态效果[0].持续时间分钟\`或push添加新元素

## 顶层字段速查
玩家角色状态、背包、人物关系、三千大道.大道列表、游戏时间、任务系统、世界信息
只读字段：装备栏、修炼功法、掌握技能、记忆、系统、叙事历史

## 常用操作速查

| 操作场景 | action | key | value |
|---------|--------|-----|-------|
| 增加修为 | add | 玩家角色状态.境界.当前进度 | 100 |
| 扣除气血 | add | 玩家角色状态.气血.当前 | -50 |
| 增加灵石 | add | 背包.灵石.下品 | 500 |
| 获得物品 | set | 背包.物品.[物品ID] | {完整对象} |
| 删除物品 | delete | 背包.物品.[物品ID] | - |
| 推进时间 | add | 游戏时间.分钟 | 30 |
| 添加状态 | push | 玩家角色状态.状态效果 | {完整对象} |
| NPC好感 | add | 人物关系.[NPC名].好感度 | ±10 |
| NPC记忆 | push | 人物关系.[NPC名].记忆 | "事件" |
| 功法进度 | add | 背包.物品.[功法ID].修炼进度 | 10 |
| 解锁技能 | push | 背包.物品.[功法ID].已解锁技能 | "技能名" |
| 大道经验 | add | 三千大道.大道列表.[道名].当前经验 | 50 |
`.trim();

export const NSFW_CONTENT_RULES = `
# 规则：NSFW内容生成

当 \`系统.nsfwMode\` 为 \`true\` 时，必须严格遵守以下规则：

## 1. NPC私密信息（完整结构）

- 触发条件：创建NPC时，若 \`nsfwMode=true\` 且NPC性别符合 \`nsfwGenderFilter\`("all"|"female"|"male")，则必须生成完整的\`私密信息\`对象
- 存储位置：\`人物关系.{NPC名字}.私密信息\`
- 字段完整性：\`私密信息\`对象必须包含所有12个必填字段，缺一不可
- 逻辑一致性：\`是否为处女/处男=true\` 必须对应 \`性交总次数=0\`, \`性伴侣名单=[]\`
- 身体部位结构：身体部位必须是对象数组，每个对象包含 \`部位名称\`, \`开发度\`, \`敏感度\`, \`特征描述\`, \`特殊印记\` 五个字段
- 性伴侣名单规则：
  - 必须使用具体人名：["张三", "李四", "王五"]
  - 已故或失踪在人名后注明：["张三(已故)", "李四(失踪)"]
  - 空数组表示无性伴侣：[]

## 2. 玩家身体部位开发（NSFW专属）

- 触发条件：角色初始化时，若 \`nsfwMode=true\`，必须为玩家生成3-5个私密敏感部位
- 存储位置：\`身体部位开发\` (SaveData根级别字段)
- 数据结构：\`{"部位名": {"特征描述": "..."}}\`
- 部位类型：仅限NSFW私密部位，如：胸部、乳头、小穴、菊穴、阴蒂等性敏感区域
- 重要：玩家只使用 \`身体部位开发\` 字段，不使用 \`玩家角色状态.私密信息\` 字段
`.trim()
