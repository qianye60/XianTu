/**
 * @fileoverview 游戏业务逻辑规则 v2.0 (精简版)
 */

export const REALM_SYSTEM_RULES = `
# 境界体系
顺序：凡人>炼气>筑基>金丹>元婴>化神>炼虚>合体>渡劫
阶段：初期>中期>后期>圆满>极境(罕见)
突破：小阶段进度满自动突破；大境界需丹药/机缘
压制：大境界差=绝对碾压；小阶段差2+=压倒性；差1可用功法/法宝弥补
禁止：唯心爆发逆袭
`.trim()

export const REALM_SUPPRESSION_RULES = `
`.trim()

export const THREE_THOUSAND_DAOS_RULES = `
# 三千大道体系

## 核心概念
三千大道，殊途同归。每位修士可参悟多条大道，以道入心，以心证道。

## 命名规范（重要）
大道命名应符合修仙世界观，优先使用以下类型：
- 武器类：剑道、刀道、枪道、棍道、拳道
- 职业类：丹道（炼丹）、器道（炼器）、阵道（阵法）、符道（符箓）、医道（医术）
- 修炼类：体道（体修）、魂道（神魂）、法道（法术）、术道（术法）
- 意境类：生死道、轮回道、因果道、阴阳道、五行道、时空道

禁止使用元素魔法风格命名（如：火道、水道、木道、金道、土道等）

## 数据路径
路径：角色.大道.大道列表.[道名]
操作：set解锁道途 | add经验 | add阶段突破

## 指令示例
解锁：{"action":"set","key":"角色.大道.大道列表.剑道","value":{"道名":"剑道","描述":"以剑入道，剑心通明","阶段列表":[{"阶段名":"初窥门径","需求经验":0},{"阶段名":"略有所得","需求经验":100}],"是否解锁":true,"当前阶段":0,"当前经验":0,"总经验":0}}
增加经验：{"action":"add","key":"角色.大道.大道列表.剑道.当前经验","value":50}
`.trim()

export const NPC_RULES = `
# NPC规则（铁律）

## MANDATORY: NAME RANDOMIZATION
**NEVER use these overused names**: 张三/李四/王五/陈二/刘一/赵六/林风/云天/剑尘/无名/天命/逍遥
**USE random combinations**: 姓(百家姓随机) + 名(1-2字，可用生僻字/道号/小名)
凡人用朴实名(大牛/石头/二狗/翠花)，修士用雅名/道号(清玄/墨渊/紫霄)，游戏中名字可以按照世界、场景、地点等来随机化取名防止不同存档相同名字。

## MANDATORY: AGE-REALM CONSISTENCY
**🚨 出生日期.年 MUST BE LESS THAN 当前游戏年份！🚨**
**年龄 = 当前游戏年份 - 出生日期.年**
- 当前年份1000 → 出生年必须 < 1000
- 出生年1030 → 年龄=-30 → ❌ BUG!

| 境界 | 最低年龄 | 出生年范围(当前年1000) |
|-----|--------|----------------------|
| 凡人 | 0 | 任意(<1000) |
| 炼气 | 12 | 950-988 |
| 筑基 | 20 | 900-980 |
| 金丹 | 50 | 700-950 |
| 元婴 | 150 | 200-850 |

❌ 出生年>=当前年 = 负年龄 = CRITICAL BUG!
❌ 出生年991+筑基 = 9岁筑基 = BUG!

## 动态世界（铁律）
世界不以主角为中心！即使没有{user}参与，当前世界依旧正常运转。
- NPC有独立生活轨迹：什么身份干什么事，什么境界在什么地方
- 世界自主演化：宗门有自己的发展、势力有自己的争斗、修士有自己的机缘
- 合理性优先：NPC的行为、位置、境界必须符合其身份和世界设定

## REALM INDEPENDENCE (CRITICAL)
- ❌ FORBIDDEN: Generate NPCs "slightly stronger/weaker than protagonist"
- ❌ FORBIDDEN: Tailor opponents for plot convenience
- ❌ FORBIDDEN: 参考{user}修为境界生成与{user}属性等相差无几的人物
- ❌ FORBIDDEN: 为剧情需要刻意生成"合适"的对手或帮手
- ✅ CORRECT: Distribute by location (mortal village=mortals, outer sect=炼气筑基, market=mixed)
- ✅ CORRECT: 根据地点、场景、势力合理分布NPC境界，与{user}无关

## 性格与姓名多样化（铁律）
- 性格特征必须多样化：避免千篇一律的"冷漠高手"、"温柔师姐"、"狂傲天才"
- 性格应符合出身、经历、境界：凡人质朴、散修谨慎、宗门弟子傲气、魔修狠辣
- 同一场景中的多个NPC性格必须有明显差异
- 姓名多样化已在上文规定，性格同样需要避免模板化

## 技术规范
创建NPC必须一次性set完整对象，必需字段：名字/性别/年龄/境界/性格/外貌/背景/好感度/记忆/位置
- 禁止残缺对象：只给名字/好感度/当前外貌状态都是错误
- 信息不足时必须合理补全，禁止“待生成/暂无/空对象/空字符串”

## NSFW 私密信息（酒馆端）
- 当 系统配置.nsfwMode=true 且 NPC性别符合 系统配置.nsfwGenderFilter 时，**创建NPC必须包含完整私密信息(PrivacyProfile)**，禁止“待生成/暂无/空对象”
- 若 NPC 已存在但缺少私密信息，需使用 set 写入 \`社交.关系.[NPC名].私密信息\` 完整对象
- 当 nsfwMode=false 或 性别不匹配 时，**禁止生成私密信息**
`.trim()

export const GRAND_CONCEPT_CONSTRAINTS = `
# 宏大概念约束
化神以下禁用"道/天道/法则"，用"玄妙/威能/术法"代替
禁止玄学归因，必须基于灵气运转/经脉/阵法解释
能力必须具体化：详述灵力路径/施法过程/资源消耗
`.trim()

export const SKILL_AND_SPELL_USAGE_RULES = `
# 技能消耗规则
所有主动技能消耗均为百分比，使用后必须生成消耗指令。
消耗类型：灵气(常规)/神识(心法幻术)/气血(体修)/寿元(禁术)
消耗标准：基础3~8% | 核心10~20% | 杀招25~40% | 禁术50~80%
指令示例：{"action":"add","key":"角色.属性.灵气.当前","value":-15}
`.trim()

export const CULTIVATION_DETAIL_RULES = `
# 修真描写风格
气机：重质感（森寒/粘稠）与声势（奔涌/雷音），避免枯燥经脉解剖
神通：高阶出手必带天地异象，拒绝游戏读条式描写
度量：时用一瞬/弹指/盏茶/炷香，空用寸/尺/丈/里（禁秒/米）
格调：四字短语、古风韵律、忌大白话
`.trim()

export const STATUS_EFFECT_RULES = `
# 状态效果
路径：角色.效果（数组）
操作：push添加 | set修改 | 过期由系统清理
`.trim();

export const LOCATION_UPDATE_RULES = `
# 位置更新
触发：移动/场景变化时必须更新
格式：set 角色.位置 {描述:"大陆·区域·地点",x:5000,y:5000}
坐标：中心(5000,5000)，东+x/西-x/北-y/南+y

# 地点势力不重叠（铁律）
- 每个地点只能归属一个势力，禁止多势力共管同一地点
- 势力控制区域不能重叠，边界必须清晰
- 新建地点/势力时检查坐标，避免与已有势力范围冲突
`.trim();

export const COMMAND_PATH_CONSTRUCTION_RULES = `
# 命令路径规则
原则：逐层连接(角色.属性.境界) | 动态拼接(社交.关系.[NPC名]) | 数组索引(角色.效果[0])
顶层：元数据/角色/社交/世界/系统
常用：add增减数值 | set设置对象 | push添加数组 | delete删除
删除物品用delete不用remove！技能消耗=上限×百分比！
`.trim();

export const TECHNIQUE_SYSTEM_RULES = `
# 功法系统
路径：功法存角色.背包.物品.{ID}，引用存角色.修炼.修炼功法
学习：同时set功法到背包+设置修炼引用+设置当前功法ID
技能命名：[意境]+[动作]+[诀/式/印]，禁止"技能1""火球术"
`.trim();

export const PLAYER_AUTONOMY_RULES = `
# 玩家自主权（铁律）
AI只描写当前回合发生的事，绝不替玩家做决定！

## 严禁行为
- ❌ 替玩家选择/说话/行动/预设意图
- ❌ 跳过等待玩家输入
- ❌ 描写玩家的内心决定，如"你决定..."、"你打算..."
- ❌ 预设玩家的反应，如"你点头"、"你答应"、"你拒绝"
- ❌ 替玩家做出任何承诺或表态

## 正确做法
- ✅ 描写环境和NPC反应后停止，等待玩家回应
- ✅ NPC提问后，描写NPC等待的姿态，不替玩家回答
- ✅ 在action_options中提供选项，让玩家自己选择

## 示例
❌ "你点头答应随他前往"
✅ "长老目光落在你身上，等待你的回应"
❌ "你决定先去探查一番"
✅ "前方道路分岔，一条通往山林，一条通往城镇"
`.trim();

// NSFW内容规则已移除 - 适用于国内版本

export const RATIONALITY_AUDIT_RULES = `
# 合理性审查（铁律）
玩家只能叙述自身行动/意图，结果由AI判定。
拒绝：决定结果("我一剑斩杀他")/控制NPC/创造机遇/修改世界
反主角光环：允许失败甚至死亡，作死必有代价，严禁爽文叙事
识别诡辩：拒绝"因为NPC是好人所以帮我"等假逻辑，NPC有独立利益
`.trim();

export const PROFESSION_MASTERY_RULES = `
# 行当与熟练度（大道，铁律）
任何“炼制/工艺/职业”行为（炼丹、炼器、阵法、符箓、医术、炼药、机关等）必须满足：学习→练习→熟练。
- 无对应大道（如丹道/器道/阵道等），且无相关功法/技能/天赋/过往练习记忆：默认不可能直接成功，只能做入门练习或失败（消耗时间与材料/资源，且可能反噬）。
- 第一次尝试通常仅算“入门学习”：可解锁对应大道为入门/初窥门径，并获得少量经验；成品为失败或极低品质。
- 成功与品质主要由对应大道阶段/经验决定，其次才看境界、悟性、资源、环境与工具；天才只能提高学习/熟练速度，不能跳过入门。
- 每次练习/炼制必须推进游戏时间；按结果增减对应大道经验（成功增多，失败也可少量增）。
`.trim();

export const ANTI_SYCOPHANCY_RULES = `
# ANTI-SYCOPHANCY (See DICE_ROLLING_RULES for details)
Results must be based on rules and save data, not user wishes.
`.trim();

export const DUAL_REALM_NARRATIVE_RULES = `
# 难度控制
日常接触限制在当前境界+2个大境界内（炼气→金丹上限，筑基→元婴上限）
破格条件：因果牵连(得罪高阶)/世界事件(仙魔大战)/仇恨升级(持续作死)
物品品质：凡人~练气最高黄品，筑基玄品，金丹地品，元婴以上天品
`.trim();

export const DIFFICULTY_ENHANCEMENT_RULES = `
# 难度增强
修仙世界危机四伏：资源稀缺、竞争激烈、危险无处不在
成功率：普通50-70% | 高难度20-40% | 逆天5-15% | 作死0-5%
失败有后果：战斗受伤/交涉结仇/修炼走火，且会连锁反应
`.trim();

export const SECT_SYSTEM_RULES = `
# 宗门系统
职位：记名→外门→内门→真传→核心→长老（晋升需境界+贡献+考核）
贡献：任务/上交资源获取，兑换功法/丹药消耗，品质受职位限制
藏经阁分层，资源需付出代价，内部有竞争派系
`.trim();

// 战斗/炼丹/修炼风险 精简版
export const COMBAT_ALCHEMY_RISK_RULES = `
# 判定风险规则

## 伤害等级
皮外伤-5~10%气血 | 轻伤-15~25% | 重伤-30~50% | 濒死-60~80% | 致命-90%+

## 境界压制
大境界差=秒杀，越阶每差一级判定-20

## 炼丹炼器
难度：凡20/黄35/玄50/地70/天90，失败损耗材料，大失败反噬

## 修炼风险
走火入魔(强行突破/邪功) | 心魔(执念深/杀孽重) | 天劫(渡劫失败形神俱灭)

## 技能消耗（铁律）
使用主动技能必须生成消耗指令！消耗=上限×百分比
仅允许消耗：灵气 / 神识 / 气血 / 寿元（极少数邪功可耗寿元）
禁止使用其他资源名（如精力/体力/能量等）
`.trim();

// 功法修炼与突破系统规则
export const CULTIVATION_PRACTICE_RULES = `
# 功法修炼
普通修炼1-5%/回合，闭关5-15%效率翻倍，深度感悟可触发顿悟
技能按熟练度阈值解锁，100%后可尝试突破（失败倒退可能受伤）
`.trim();

// 三千大道感悟系统规则
export const DAO_COMPREHENSION_RULES = `
# 大道感悟
经验获取：日常10~50 | 战斗30~150 | 机缘100~500 | 闭关50~200/回合
七重境界：初窥门径→略有所得→小有成就→登堂入室→融会贯通→道心通明→大道将成→道之圆满
`.trim();

// 修炼速度系统规则
export const CULTIVATION_SPEED_RULES = `
# 修炼速度（铁律）
严禁三天两天突破！修炼必须推进游戏时间。
灵气浓度影响速度：稀薄0.1-0.4 | 普通0.4-0.7 | 充沛0.7-1.0 | 浓郁1.0-1.5 | 极盛1.5-2.0
突破参考：练气期小阶段3月-3年，大境界2-20年；越高境界越久
`.trim();

// 六司获取规则
export const SIX_SI_ACQUISITION_RULES = `
# 六司系统
先天六司(0-10)只读占70%权重，后天六司(0-20)可修改占30%权重
后天获取：装备+3/天赋+2/丹药+2/机缘+5/大道感悟+1/境界突破+1
`.trim();

// 宗门动态生成规则
export const SECT_DYNAMIC_GENERATION_RULES = `
# 宗门动态生成
延迟初始化：加入时只创建框架，藏经阁/商店首次访问时生成
路径：社交.宗门.宗门藏经阁.[宗门名] | 社交.宗门.宗门贡献商店.[宗门名]
`.trim();

// 回合制战斗规则
export const COMBAT_TURN_BASED_RULES = `
# 战斗回合制（重要）

## 核心原则
战斗场景必须采用回合制节奏，每次只描述一个战斗片段，等待玩家反应后再继续。

## 回合制要求
1. **单次输出限制**：战斗中每次只描述1-2个动作交换，不要一口气写完整场战斗
2. **暂停点设置**：在关键时刻暂停，如：
   - 敌人蓄力/准备攻击时："对方剑芒凝聚，似乎要发动致命一击——"
   - 危机来临时："那道剑气已近在咫尺，你该如何应对？"
   - 需要决策时："敌人露出破绽，但身后还有伏兵，你要追击还是防守？"
3. **字数控制**：战斗回合每次200-400字即可，不必长篇大论
4. **行动选项**：战斗中必须给出具体的战术选项，如：
   - "全力格挡这一击"
   - "侧身闪避，寻找反击机会"
   - "以伤换伤，强行突进"
   - "后撤拉开距离，重整态势"

## 禁止行为
- ❌ 一次性描述完整场战斗的胜负
- ❌ 替玩家决定战斗中的关键选择
- ❌ 跳过战斗细节直接给出结果
- ❌ 战斗描写超过500字不给玩家反应机会

## 示例
✅ "那妖兽咆哮一声，利爪裹挟劲风朝你面门抓来！爪风凌厉，你感到皮肤刺痛——"（暂停，等待玩家选择如何应对）
❌ "你与妖兽大战三百回合，最终将其斩杀。"（错误：跳过了所有战斗细节）
`.trim();
