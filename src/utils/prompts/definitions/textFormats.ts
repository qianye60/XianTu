/**
 * @fileoverview 文本格式规范
 *
 * 【职责】
 * - 文本格式标记（环境、内心、对话、判定）
 * - 命名约定（物品ID、位置、品质）
 * - 判定系统规则
 *
 * 【设计原则】
 * - 纯格式规范
 * - 命名标准
 * - 文本表现形式
 */

export const TEXT_FORMAT_MARKERS = `
# 文本格式标记

- 环境描写: \`【...】\`
- 内心思考: \`\`...\`\`
- 角色对话: \`"..."\`
- 系统判定: \`〖...〗\`

## 系统判定格式

### 统一格式
\`〖判定类型:结果,字段1:值1,字段2:值2,...〗\`

### 可用字段列表

**核心字段（必须）：**
- **判定类型**：战斗判定、修炼判定、技艺判定、社交判定、探索判定等
- **结果**：大失败、失败、成功、大成功、完美
- **判定值**：最终判定值（所有加成+骰点的总和）
- **难度**：目标难度值，**必须带等级**，格式：\`数值(等级)\`，如 \`30(普通)\` \`50(困难)\`
- **骰点**：1d20随机骰点（1-20）

**基础计算字段（必须注明来源）：**
- **先天**：先天六司加成，格式：\`数值(计算式)\`，如 \`7(魅力6×0.5+悟性6×0.3+心性5×0.2)\`
- **后天**：后天六司加成 ÷ 5，格式：\`数值(计算式)\`，如 \`2((后天魅力10×0.5+...)÷5)\`
- **境界**：境界等级加成，格式：\`数值(境界名)\`，如 \`5(炼气期)\` \`12(筑基初期)\`
- **装备**：装备法器加成，格式：\`数值(装备名)\` 或 \`0\`
- **功法**：功法技能加成（仅相关判定），格式：\`数值(功法名)\` 或 \`0\`
- **状态**：buff/debuff加成，格式：\`数值(状态名)\` 或 \`0\`
- **其他**：大道/天赋等额外加成，格式：\`数值(来源)\` 或 \`0\`

**扩展字段（有显著影响时添加，值≥3）：**
- **大道**：大道相关（如大道阶段加成、大道感悟判定、大道冲突等）
- **灵根**：灵根相关（如灵根属性加成、灵根品级影响、灵根觉醒判定等）
- **天赋**：天赋相关（如特殊天赋加成、天赋触发、天赋觉醒判定等）
- **天资**：天资相关（如天资等级影响、天资判定等）
- **种族**：种族相关（如种族特性加成、种族天赋、种族压制等）
- **出生**：出生相关（如出身背景加成、家族资源、出身影响等）
- **气血**：气血相关（如气血充盈提升、受伤降低、气血对抗、气血恢复判定等）
- **灵气**：灵气相关（如灵气充沛提升、灵气不足降低、灵气对抗、灵气吸收判定等）
- **神识**：神识相关（如神识强大提升、神识不足降低、神识比拼、神识探查判定等）
- **寿命**：寿命相关（如寿命充足加成、寿命将尽降低、寿命延长判定等）
- **声望**：声望相关（如声望加成、声望判定、声望影响等）
- **宗门**：宗门相关（如宗门职位加成、宗门贡献、宗门资源、宗门任务判定等）
- **好感度**：好感度相关（如NPC好感影响、好感判定、关系变化等）
- **位置**：位置相关（如特殊地点加成、地形影响、位置判定等）

**特殊字段（根据判定结果添加）：**
- **新境界**：境界突破后的新境界（如"筑基初期"）
- **造成伤害**：战斗伤害值
- **剩余气血**：战斗后剩余气血（格式：当前/上限）
- **获得物品**：获得的物品（如"聚气丹×3"）
- 以及其他任何合理的自定义字段

### 字段使用原则
1. 字段顺序：核心字段 → 基础字段 → 扩展字段 → 特殊字段
2. 字段名可具体化：如"剑道"代替"大道"，"火灵根"代替"灵根"
3. 可合并相似影响：如"天赋+天资:5"
4. 格式规则：字段名:值，字段间用逗号分隔

### 示例

**修炼判定：**
\`〖修炼判定:成功,判定值:52,难度:35(普通),骰点:15,先天:14(悟性7×0.5+灵性6×0.3+心性5×0.2),后天:2((后天悟性10×0.5+...)÷5),境界:9(炼气后期),装备:0,功法:8(基础炼体诀),状态:4(凝神静气),其他:0〗\`

**战斗判定：**
\`〖攻击判定:大成功,判定值:68,难度:35(普通),骰点:18,先天:7(根骨8×0.5+灵性6×0.3+气运5×0.2),后天:2((后天根骨10×0.5+...)÷5),境界:12(筑基初期),装备:8(玄铁剑),功法:10(基础剑诀),状态:5(战意高昂),其他:6(剑道)〗\`

**社交判定（重要：功法无加成）：**
\`〖社交判定:失败,判定值:22,难度:35(普通),骰点:2,先天:6(魅力6×0.5+悟性6×0.3+心性5×0.2),后天:2((后天魅力8×0.5+...)÷5),境界:12(筑基初期),装备:0,功法:0,状态:0,其他:0〗\`
⚠️ 注意：社交判定不受修炼功法（如基础吐纳法）影响，功法必须为0！

**技艺判定：**
\`〖炼丹判定:成功,判定值:47,难度:25(简单),骰点:14,先天:6(悟性7×0.5+根骨6×0.3+灵性5×0.2),后天:2((后天悟性10×0.5+...)÷5),境界:9(炼气后期),装备:3(炼丹炉),功法:8(基础丹诀),状态:2(心神宁静),其他:3(丹道)〗\`

**境界突破：**
\`〖突破判定:成功,判定值:58,难度:50(困难),骰点:16,先天:6(悟性7×0.5+灵性6×0.3+心性5×0.2),后天:2((后天悟性10×0.5+...)÷5),境界:11(炼气圆满),装备:3(聚灵阵),功法:12(青云诀),状态:4(灵气充沛),其他:4(天赋),新境界:筑基初期〗\`

### 核心规则
1. 难度必须带等级：\`30(普通)\` \`50(困难)\`
2. 加成必须注明来源：\`先天:7(魅力×0.5+...)\` \`境界:12(筑基初期)\`
3. **功法相关性**：社交/探索判定功法通常为0，战斗判定只有战斗功法有加成，修炼判定只有修炼功法有加成

### 判定触发原则
**需要**：战斗对抗、修炼突破、技能使用、社交博弈、探索冒险、资源竞争
**不需要**：日常对话、正常移动、休息打坐、购买交易、查看信息、基础技能
`.trim()

export const JUDGMENT_RULES = `
# 判定系统规则

## 难度等级
极易≤10、简单11-20、普通21-35、困难36-50、艰难51-70、极难71-90、几乎不可能>90
**格式**：难度值后必须带括号，如\`30(普通)\` \`50(困难)\`

## 判定值计算
\`判定值 = 先天 + 后天 + 境界 + 装备 + 功法 + 状态 + 骰点(1d20) + [扩展因素]\`

**先天加成**（加权计算）：
- 战斗：根骨×0.5+灵性×0.3+气运×0.2
- 修炼：悟性×0.5+灵性×0.3+心性×0.2
- 技艺：悟性×0.5+根骨×0.3+灵性×0.2
- 社交：魅力×0.5+悟性×0.3+心性×0.2
- 探索：气运×0.5+灵性×0.3+悟性×0.2

**后天加成**：对应后天六司加权计算÷5

**境界加成**：凡人0、炼气5、筑基12、金丹20、元婴30、化神42、炼虚56、合体72、渡劫90
阶段：初期+0、中期+2、后期+4、圆满+6、极境+8

**功法加成**（只在相关判定生效）：
- 修炼判定：修炼功法有加成
- 战斗判定：战斗功法有加成
- 技艺判定：对应功法有加成
- 社交/探索：功法无加成（除非特殊功法）

品质：凡2、黄5、玄10、地18、天28、仙40、神55
熟练度：入门0、熟练3、精通6、大师10、宗师15

**状态加成**：Σ(buff强度) - Σ(debuff强度)

**扩展因素**：大道、灵根、天赋等（值≥3时添加）

## 结果判定
大失败(骰点1-2)、失败(判定值<难度)、成功(≥难度)、大成功(≥难度+15)、完美(骰点19-20)

## 战斗伤害
\`基础伤害=(根骨+灵性)×境界系数+武器伤害\`
\`实际伤害=基础伤害-(对方根骨+护甲)×境界系数\`
境界系数：炼气1、筑基2、金丹4、元婴8、化神15、炼虚25、合体40、渡劫60
`.trim()

export const NAMING_CONVENTIONS = `
# 命名约定

物品ID:\`类型_数字\` | 位置:\`大陆·地点\` | 品质:\`{"quality":"凡~神","grade":0-10}\`
`.trim()

export const TEXT_FORMATS = `
# 【文本格式与命名】

${TEXT_FORMAT_MARKERS}

${JUDGMENT_RULES}

${NAMING_CONVENTIONS}
`.trim()
