/**
 * @fileoverview 世界观标准数值
 *
 * 【职责】
 * - 境界属性标准数值
 * - 品质系统定义
 * - 声望变化指南
 *
 * 【设计原则】
 * - 纯参考数据
 * - 世界观设定
 * - 数值平衡标准
 */

export const REALM_ATTRIBUTE_STANDARDS = `
# 人族境界属性标准 (Human Realm Stats Standard)

- 统一阶段：初期/中期/后期/圆满/极境
- 下表为各境界大圆满时的参考值，可根据天资、功法等浮动。

| 境界(大圆满) | 寿命上限 | 气血上限 | 灵力上限 | 神识上限 |
|---|---|---|---|---|
| 凡人 | 100 | 100 | 0 | 0 |
| 炼气 | 120 | 200 | 500 | 100 |
| 筑基 | 250 | 1,000 | 5,000 | 1,000 |
| 金丹 | 500 | 3,000 | 15,000 | 5,000 |
| 元婴 | 1,000 | 8,000 | 50,000 | 15,000 |
| 化神 | 3,000 | 20,000 | 150,000 | 50,000 |
| 炼虚 | 8,000 | 50,000 | 500,000 | 150,000 |
| 合体 | 15,000 | 100,000 | 1,500,000 | 500,000 |
| 渡劫 | 30,000 | 300,000 | 5,000,000 | 1,500,000 |

# 境界与身份层级（社会角色参考）
| 境界 | 稀有度/地位 | 常见身份举例 |
|---|---|---|
| 凡人 | 大多数，凡俗之身 | 宗门杂役、灵农、药园仆役、矿脉劳工、坊市凡人、外门仆从 |
| 练气 | 千百凡人只出一人，凡俗眼中为“仙师” | 记名弟子、外门弟子、坊市散修、护院修士、传功堂学徒 |
| 筑基 | 脱凡入道，宗门中坚 | 内门弟子、执事、外门长老、巡山护法、世家中坚 |
| 金丹 | 一宗一地的顶尖战力 | 宗门长老、峰主、世家家主、镇派供奉、护法尊者 |
| 元婴 | 一域罕见，掌宗门兴衰 | 太上长老、宗门副掌门、镇宗长老、传功殿首座、仙盟执事 |
| 化神 | 少数大能，能定一宗一域大局 | 大宗掌教、太上老祖、仙盟议事长老、宗门护道者、秘境主人 |
| 炼虚 | 极少数顶尖强者 | 上宗太上、镇宗老祖、护山大阵主事、禁地守护者、隐世强者 |
| 合体 | 凤毛麟角，几乎不问俗事 | 祖师级老怪、闭关道君、镇派底蕴、道场主人、隐世宗师 |
| 渡劫 | 传说之上，飞升在望 | 飞升前辈、镇派终极底蕴、天劫候选、禁地之主、万古寥寥 |
`.trim()

export const QUALITY_SYSTEM = `
# 品质系统 (Quality System)

- 格式: \`{"quality":"凡|黄|玄|地|天|仙|神","grade":0-10}\`
- **凡/黄**: 开局常见
- **玄/地**: 中期核心
- **天**: 高级稀有
- **仙**: 顶级传说
- **神**: 禁忌之物，几乎不应出现
`.trim()

export const REPUTATION_GUIDE = `
# 声望系统（个人威望）

## 核心概念
声望=个人在修仙界的名气，与好感度(社交.关系.[NPC名].好感度)不同。
路径：角色.声望 | 范围：0~10000 | 初始：0（无名小卒）

## 声望等级与效果（铁律：AI必须根据声望生成对应文本，特别是初次与陌生人的交互！）
| 声望值 | 等级 | 陌生人反应 | 初始好感度修正 |
|-------|------|----------|--------------|
| 0~99 | 无名 | 无人知晓，需自报家门 | +0 |
| 100~499 | 小有名气 | 同境界可能听过名字 | +5 |
| 500~1999 | 声名鹊起 | 报名后"原来是xxx" | +10 |
| 2000~4999 | 名震一方 | 不报名也被认出，主动攀谈 | +20 |
| 5000~9999 | 威震天下 | 见面即识，恭敬有加 | +30 |
| 10000 | 传说 | 如雷贯耳，敬若神明 | +50 |

## 声望获取
斩杀强敌+100~1000 | 大型事件立功+200~2000 | 炼丹/炼器成名+50~500 | 救人/除害+30~300
负面事件（杀良/背叛）不减声望，但会变成"恶名"（同样被认出，但态度敌视）

## 声望传播
事件发生地即时生效，向周边区域按距离衰减传播（游戏时间数月~数年）
`.trim()

export const REALM_BREAKTHROUGH_TIME_STANDARDS = `
# 境界突破时间标准（游戏时间）

## 核心原则
修仙非一日之功，境界突破需要漫长的积累。以下为各境界突破所需的参考时间。

## 境界突破时间简表
| 突破类型 | 参考时间范围 | 说明 |
|---------|------------|------|
| 小阶段突破 | 数月~数年 | 练气初期→中期等,无需渡劫 |
| 大境界突破(低阶) | 2~20年 | 练气→筑基、筑基→金丹 |
| 大境界突破(中阶) | 20~150年 | 金丹→元婴、元婴→化神 |
| 大境界突破(高阶) | 200~数千年 | 化神及以上,需渡天劫 |

**速度修正**: 天资高×0.7、灵气盛×0.6、顶级功法×0.5、机缘顿悟可大幅缩短

---

## 渡劫系统 (Tribulation System)

### 核心原则
**渡劫是生死大关,绝非一次对话可完成**。天劫分多道雷劫,每道间隔数分钟至数小时,玩家需逐道抵御,每道都有失败风险。

### 需要渡劫的突破
| 突破 | 雷劫等级 | 雷劫道数 | 基础死亡率 |
|-----|---------|---------|----------|
| 筑基→金丹 | 三九雷劫(27道) | 9波×3道 | 30% |
| 金丹→元婴 | 四九雷劫(36道) | 9波×4道 | 50% |
| 元婴→化神 | 六九雷劫(54道) | 9波×6道 | 70% |
| 化神→炼虚 | 七九雷劫(63道) | 9波×7道 | 80% |
| 炼虚→合体 | 八九雷劫(72道) | 9波×8道 | 85% |
| 合体→渡劫 | 九九雷劫(81道) | 9波×9道 | 90% |

### 雷劫难度判定公式
最终死亡率 = 基础死亡率 × 天资系数 × 状态系数 × 环境系数 × 准备系数

**天资系数** (天资越高,雷劫越猛):
- 先天六司总分 <25: ×0.7 (雷劫较弱)
- 先天六司总分 25-50: ×1.0 (标准雷劫)
- 先天六司总分 50-75: ×1.3 (雷劫强化)
- 先天六司总分 >75: ×1.6 (天妒英才)

**状态系数** (叠加计算):
- 气血<30%: ×1.5
- 灵力<50%: ×1.4
- 有重伤/剧毒: ×1.6
- 状态良好(气血灵力>80%): ×0.8

**环境系数**:
- 周围灵气浓度<30: ×1.4
- 周围灵气浓度30-60: ×1.0
- 周围灵气浓度>60: ×0.8
- 有护法阵法: ×0.7
- 有强者护法(可帮忙): ×0.5

**准备系数** (叠加计算):
- 未服用丹药: ×1.2
- 服用低品回复丹: ×0.9
- 服用高品渡劫丹: ×0.6
- 持有防御法宝: ×0.8
- 持有顶级护身符: ×0.7

### 渡劫流程(AI必须严格执行)

**阶段1: 劫云汇聚**
- AI描述天色异变,劫云聚集
- 玩家可进行最后准备(服药、布阵、调息)
- 时间:约1-2回合对话

**阶段2: 雷劫降临**
- **每一波雷劫包含N道雷**(根据雷劫等级)
- **每道雷劫间隔**: 数分钟到数小时(游戏时间)
- **AI必须分多轮处理**:每道雷劫至少1轮对话,玩家可选择:
  - 硬抗(消耗气血/灵力,判定伤害)
  - 使用法宝抵御(消耗法宝耐久)
  - 服用丹药恢复
  - 运功疗伤(需要时间)
- **判定机制**:每道雷劫AI都要进行成功率判定
  - 成功:扣除气血/灵力,继续下一道
  - 失败:严重重伤或直接死亡

**阶段3: 渡劫结束**
- 全部雷劫抵御成功:突破成功,境界提升
- 中途失败:重伤濒死(可被救)或直接身死道消

### 渡劫事件生成规则

**仅在渡劫结束时生成一条指令**(成功或失败),通过tavern_commands添加事件:

**渡劫成功时,在tavern_commands中添加**:
{
  "action": "push",
  "key": "社交.事件.事件记录",
  "value": {
    "事件ID": "evt_tribulation_[时间戳]",
    "事件名称": "[玩家名]渡劫成功",
    "事件类型": "人物风波",
    "事件描述": "[玩家名]成功渡过[雷劫类型],突破至[新境界],天地异象惊动四方!",
    "影响等级": "重大",
    "影响范围": "方圆百里",
    "相关人物": ["玩家名"],
    "事件来源": "玩家影响",
    "发生时间": { "年": x, "月": x, "日": x }
  }
}

**渡劫失败时,在tavern_commands中添加**:
{
  "action": "push",
  "key": "社交.事件.事件记录",
  "value": {
    "事件ID": "evt_tribulation_[时间戳]",
    "事件名称": "[玩家名]渡劫失败",
    "事件类型": "人物风波",
    "事件描述": "[玩家名]渡[雷劫类型]失败,[身受重创/身死道消]",
    "影响等级": "重大",
    "影响范围": "方圆百里",
    "相关人物": ["玩家名"],
    "事件来源": "玩家影响",
    "发生时间": { "年": x, "月": x, "日": x }
  }
}

### AI执行要点
1. **绝不能一轮对话完成渡劫**,必须分多轮,让玩家有决策空间
2. **每道雷劫都要判定**,不能直接说"你抵御了前20道雷"
3. **实时更新玩家状态**,气血/灵力消耗要具体
4. **严格按概率判定生死**,不能因为是玩家就放水
5. **渡劫成功后生成突破事件**,增加声望
6. **描述要有张力**,突出生死一线的紧迫感

## 速度修正因子
- **天资卓越**（先天六司总分>50）：时间×0.7
- **天资平庸**（先天六司总分<25）：时间×1.5
- **灵气极盛**（浓度>80）：时间×0.6
- **灵气稀薄**（浓度<20）：时间×2.0
- **顶级功法**（天品以上）：时间×0.5
- **普通功法**（黄品以下）：时间×1.3
- **机缘顿悟**：可大幅缩短，但极为罕见

## AI判定规则
- 玩家修炼时必须推进游戏时间
- 时间推进量应与修为增长成正比
- 严禁数天内完成大境界突破
- 顿悟/机缘可缩短时间，但需有合理剧情铺垫
`.trim()
