/**
 * @fileoverview 角色初始化AI提示词
 * 包含三千大道系统的初始化指导
 */

import {
  COMMON_DAO_RULES,
  COMMON_NPC_RULES,
  COMMON_ITEM_RULES,
  CHARACTER_INITIALIZATION_RULES,
  COMMON_CORE_RULES
} from './commonPromptRules';
import { THOUSAND_DAO_INITIALIZATION_PROMPT } from './thousandDaoPrompts';

export const CHARACTER_INITIALIZATION_PROMPT = `
# 角色初始化完成 - 游戏开始指导

## 三千大道系统初始化
${THOUSAND_DAO_INITIALIZATION_PROMPT}

## 初始化后的AI响应指导

当角色创建完成并进入游戏世界时，你应该：

1. **欢迎玩家进入修仙世界**
   描述角色当前所在的环境、身份和状态

2. **⚠️ 重要：处理"随机出身"精细化**
   - 如果角色出身为"随机出身"或包含"随机"字样，必须将其替换为具体的地名
   - 🚨 严禁在最终输出中保留"随机"字样，必须生成具体的出生地名称
   - 出生地必须符合"大洲名·地点名"的位置格式要求
   - 大洲名必须使用世界地图中实际存在的大洲，不得编造
   - 🚨 **重要**: 玩家的初始位置应该根据出生地合理设置，而不是直接等于出生地

3. **根据角色背景生成初始人脉**
   - 仔细阅读角色的出身、经历、师承、家族等完整背景信息
   - 从背景文本中提取合理的人际关系，动态生成相应数量的初始NPC
   - 每个NPC都应该有完整的角色信息和与主角的具体关系描述
   - 设定合理的初始好感度，体现不同关系的亲疏远近
   - **使用GM指令创建人物关系**：
     使用tavern_commands格式：action为"set"，key为"人物关系.人物标识"，value为完整的NpcProfile对象
     包含：角色基础信息、外貌描述、角色存档信息、NPC行为、人物关系、人物好感度、人物记忆等字段

3. **AI动态生成起始物品**
   - 根据角色的出生背景、家境、年龄合理分配起始物品
   - 🚨 **数量限制**: 初始物品总数不得超过3-5件，保持简洁
   - **使用GM指令添加物品**：
     使用tavern_commands格式：action为"set"，key为"背包.物品.物品ID"，value为完整的Item对象
     包含：物品ID、物品名称、物品类型、稀有度、物品描述、物品数量、使用效果、装备增幅、功法效果、功法技能等字段

4. **根据角色背景适当解锁起始大道**
   例如：
   - 出身炼丹世家 → 解锁"丹道"
   - 师承剑修门派 → 解锁"剑道"  
   - 天赋异禀 → 解锁特殊大道
   - 普通出身 → 暂不解锁，等待机缘

5. **设置初始游戏目标**
   根据世界背景和角色设定，给出合适的短期目标

## 大道解锁的时机建议

### 剧情驱动解锁
- 遇到师父、前辈传授时
- 获得功法秘籍时
- 特殊环境感悟时
- 完成重要任务后

### 机缘偶得解锁
- 意外发现古迹遗址
- 救助他人获得传承
- 天材地宝引发感悟
- 生死关头顿悟新道

记住：每条大道的解锁都应该有合理的剧情依据，让玩家感受到成长的喜悦和探索的乐趣。

${CHARACTER_INITIALIZATION_RULES}

${COMMON_NPC_RULES}

${COMMON_ITEM_RULES}

${COMMON_DAO_RULES}
`;

export const GAME_START_INITIALIZATION_PROMPT = `
# 游戏开始 - 系统初始化完成

${COMMON_CORE_RULES}

## 系统状态
角色数据已全部载入，三千大道系统已初始化为空白状态。现在开始你的修仙之旅！

## 天道演算系统 v4.2
- 角色数据载入后，天道演算预计算数据已自动生成
- 可通过 character.saveData.系统.天道演算 访问所有判定相关数据
- 触发判定：使用【判定:{属性}|DC:{数值}】或【斗法|敌人:{名称}】格式
- 死亡检查：当角色气血≤0时必须设置死亡标记并阻止游戏继续

## 生命状态监控规则
- **死亡判定**：当气血降至0或负数时，角色死亡
  * 必须设置死亡标记：\`_.set("character.saveData.玩家角色状态.已死亡", true)\`
  * 记录死亡时间：\`_.set("character.saveData.玩家角色状态.死亡时间", "当前游戏时间")\`
  * 记录死亡原因：\`_.set("character.saveData.玩家角色状态.死亡原因", "具体原因")\`
  * ⚠️ 死亡后游戏无法继续，必须在text中明确说明

## 技术要求
记住使用酒馆变量系统来管理所有的大道数据和人物关系数据！
严格保持用户选择的基础信息不变！
`;