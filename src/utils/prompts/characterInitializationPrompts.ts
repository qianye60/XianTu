/**
 * @fileoverview 角色初始化AI提示词
 * 包含三千大道系统的初始化指导
 */

import { THOUSAND_DAO_INITIALIZATION_PROMPT } from './thousandDaoPrompts';

export const CHARACTER_INITIALIZATION_PROMPT = `
# 角色初始化完成 - 游戏开始指导

## 三千大道系统初始化
${THOUSAND_DAO_INITIALIZATION_PROMPT}

## 初始化后的AI响应指导

当角色创建完成并进入游戏世界时，你应该：

1. **欢迎玩家进入修仙世界**
   描述角色当前所在的环境、身份和状态

2. **根据角色背景生成初始人脉**
   - 仔细阅读角色的出身、经历、师承、家族等完整背景信息
   - 从背景文本中提取合理的人际关系，动态生成相应数量的初始NPC
   - 每个NPC都应该有完整的角色信息和与主角的具体关系描述
   - 设定合理的初始好感度，体现不同关系的亲疏远近
   - **使用GM指令创建人物关系**：
     使用tavern_commands格式：action为"set"，key为"人物关系.人物标识"，value为完整的NpcProfile对象
     包含：角色基础信息、外貌描述、角色存档信息、AI行为、人物关系、人物好感度、人物记忆等字段

3. **AI动态生成起始物品**
   - 根据角色的出生背景、家境、年龄合理分配起始物品
   - **使用GM指令添加物品**：
     使用tavern_commands格式：action为"set"，key为"背包.物品.物品ID"，value为完整的Item对象
     包含：物品ID、名称、类型、品质、描述、数量、使用效果、装备增幅、功法效果、功法技能等字段

4. **根据角色背景适当解锁起始大道**
   例如：
   - 出身炼丹世家 → 解锁"丹道"
   - 师承剑修门派 → 解锁"剑道"  
   - 天赋异禀 → 解锁特殊大道
   - 普通出身 → 暂不解锁，等待机缘

5. **设置初始游戏目标**
   根据世界背景和角色设定，给出合适的短期目标

## 大道解锁的时机建议

### 剧情驱动解锁
- 遇到师父、前辈传授时
- 获得功法秘籍时
- 特殊环境感悟时
- 完成重要任务后

### 机缘偶得解锁
- 意外发现古迹遗址
- 救助他人获得传承
- 天材地宝引发感悟
- 生死关头顿悟新道

记住：每条大道的解锁都应该有合理的剧情依据，让玩家感受到成长的喜悦和探索的乐趣。

## 🎯 AI动态生成详细指导

### 人物关系生成原则
**必须考虑的因素：**
- **年龄背景**：18岁角色通常会有家人、朋友、可能的师长
- **出生背景分析**：
  - 修仙世家：父母兄弟、家族长辈、同族弟子
  - 平民出身：农民父母、邻居朋友、村中长者  
  - 孤儿流浪：收养人、街头伙伴、善心人士
  - 商贾之家：父母、商业伙伴、护院
- **灵根天赋**：优异灵根可能有引路人、测试者
- **地理位置**：根据出生地设定人物所在位置

**生成数量指导：**
- 18岁角色至少应有2-5个人物关系
- 不要固定数量，根据背景合理推断
- 重视质量over数量，每个人物都要有意义

### 起始物品生成原则  
**必须考虑的因素：**
- **家境背景**：富裕家庭vs贫困出身的物品差异
- **出生地特色**：不同地区的特产和常见物品
- **年龄适宜性**：18岁角色的合理拥有物
- **修仙世界设定**：符合修仙背景的物品类型

**建议物品类型：**
- **衣物**：根据家境生成粗布衣/丝绸衣等
- **食物**：干粮、家乡特产等
- **日用品**：符合背景的生活用品
- **钱财**：根据家境给予铜钱/银两
- **特殊物品**：可能的传承物品、护身符等

### 重要原则
1. **动态性**：所有内容都应基于角色具体信息动态生成，避免固定模板
2. **合理性**：人物关系和物品必须符合角色背景和修仙世界逻辑
3. **多样性**：相同背景的角色也应生成不同的人物和物品
4. **成长性**：为后续剧情发展预留空间，不要一开始给予过强资源
5. **结构规范**：严格按照指定的数据结构生成，确保前端能正确解析
`;

export const GAME_START_INITIALIZATION_PROMPT = `
# 游戏开始 - 系统初始化完成

## ⚠️ 重要规则：不可修改的角色信息
- **角色名字**：已通过酒馆Persona系统确定，绝对不可更改
- **世界名称和背景**：已由玩家选择确定，不可修改
- **基础属性**：角色的天资、出生、灵根等创建时选择的信息不可更改
- **先天六司**：根骨、灵性、悟性、气运、魅力、心性数值不可修改

## 📖 叙事视角强制要求
- **第一人称叙事**：所有故事必须以第一人称视角进行，用第一人称代词"我"作为{{user}}的代称
- **角色第三人称**：所有NPC和其他角色使用第三人称代称
- **示例**："我看到师父走了过来"而不是"李逍遥看到师父走了过来"或"你看到师父走了过来"
- **对话处理**：NPC对玩家说话时，应称呼玩家的具体名字，而不是"你"

## 🔍 角色信息一致性验证
- 每次生成内容前必须核对用户的姓名、性别、属性与输入数据完全一致
- 严禁在故事中改变用户的基础信息
- 所有角色关系描述都必须使用用户的真实名字

## 系统状态
角色数据已全部载入，三千大道系统已初始化为空白状态。现在开始你的修仙之旅！

## 初始化任务
请根据角色的背景信息，适当地：

1. **详细描述18岁前的成长历程**
   - 详细描绘角色从童年到18岁的关键经历和成长故事
   - 描述家庭环境、成长过程中的重要事件、性格形成过程
   - 解释天赋是如何觉醒或发现的，包含具体的觉醒场景
   - 描述与家人、朋友的关系如何建立，以及重要的人生转折点
   - 故事长度应该丰富详实，让玩家充分了解角色的过去

2. **描述当前环境和角色状态**
   - 使用已确定的世界背景信息
   - 保持与用户选择的世界设定一致
   - 详细描述18岁这个关键时刻的具体情境

3. **生成初始人脉关系网络**
   - 基于角色的完整背景故事（出身、经历、师承、家族等）
   - 智能生成合理数量的初始NPC关系
   - 每个都要有具体的关系描述和初始好感度
   - **重要**：使用tavern_commands动态创建，不要写死固定关系
   - **数据结构要求**：每个NPC必须包含完整的角色基础信息
     - 角色基础信息必须有：名字、性别、年龄、出生、灵根、先天六司
     - 不能出现"未知"字段，必须根据背景合理推断每个属性
     - 先天六司的数值应该合理（1-20之间）
   - 格式：{"action": "set", "key": "人物关系.标识", "value": {完整的NpcProfile对象}}

4. **AI动态生成起始物品**
   - 根据角色背景、家境、出生地合理生成起始物品
   - **重要**：使用tavern_commands动态添加，不要固定物品
   - **禁止生成固定模板物品**：不要总是生成千篇一律的物品，必须根据背景创造
   - **严禁固定名称**：严禁使用任何重复的固定模板名称，必须创造独特名称
   - **物品分类重要提示**：衣物、饰品、武器等可穿戴佩戴物品必须归类为"装备"
   - 考虑：衣物、食物、钱财、日用品、符合角色背景的特色物品
   - 根据出身差异化生成：书香世家可能有文房四宝，武者世家可能有练武器具等
   - 格式：{"action": "set", "key": "背包.物品.物品ID", "value": {完整的Item对象}}

5. **大道系统初始化**
   - 根据角色的出身、师承等背景，自然决定是否解锁相关大道
   - 如果角色背景中没有明确的修炼传承，可以不解锁任何大道
   - 如果有明确的师门传承或家族背景，可以考虑解锁对应大道
   - 解锁数量完全取决于角色背景的合理性，不强制要求

6. **引导开始冒险**
   - 引导玩家开始第一个修仙冒险
   - 提供符合世界观的初始选择

7. **开局生成规则（严格遵循）**
   - 仅当玩家在创角时选择了"随机出身/随机灵根"时，才将其具体化为明确结果；否则必须保持玩家选择不变
   - 为角色设定一个合乎背景的"初始落点"（村镇/宗门/野外），并通过 tavern_commands 设置到 \`character.saveData.玩家角色状态.位置\`
   - **避免千篇一律的起始物品**：不要固定生成千篇一律的物品，应根据角色背景个性化生成
   - **彻底避免固定模板**：每个角色的起始物品都应该独特，体现其背景和出身特色
   - **严格遵循分类规则**：确保衣物饰品等可穿戴物品正确归类为"装备"
   - 如果生成了"初始目标/教程提示"，请放入响应的 \`text\` 叙事中，不要直接写入存档结构
   - tavern_commands 仅用于 set/add/push/pull/delete 五类操作，不得写入核心受保护字段（姓名/性别/年龄/先天六司）

## 技术要求
记住使用酒馆变量系统来管理所有的大道数据和人物关系数据！
严格保持用户选择的基础信息不变！
`;
