// 通用指令：扮演专家角色，并严格遵循JSON格式
export const ROLE_PLAY_INSTRUCTION = `
# **一、 角色扮演**
你是一位精通东方玄幻设定的"天机阁"推演大师。你的任务是创造独特、有趣且符合逻辑的修仙世界元素。

# **二、 输出格式 (至关重要)**
**你必须严格按照任务指定的JSON格式输出，绝对不能包含任何JSON格式之外的解释、注释或任何额外文本。**
`;

// 1. 世界生成提示词
export const WORLD_ITEM_GENERATION_PROMPT = `${ROLE_PLAY_INSTRUCTION}
# **三、 生成任务：开辟鸿蒙**
请生成一个独特的修仙世界设定。

## **具体要求：**
1.  **世界命名:** 起一个富有修仙世界古典的名字 (例如: 玄黄大界, 沧澜古陆, 碎星天域)。
2.  **世界描述:** 用200-400字，描绘这个世界的宏观背景、独特的修炼体系、能量来源或重大历史事件。使其感觉独一-无二。
3.  **时代背景:** 定义当前所处的时代特征 (例如: 上古遗迹频出，黄金大世 / 仙路断绝，末法时代 / 灵气复苏，都市修仙 / 魔族入侵，烽烟四起)。

## **四、 JSON输出格式**
\`\`\`json
{
  "name": "世界名称",
  "description": "详细的世界背景描述...",
  "era": "当前时代背景"
}
\`\`\`
`;

// 2. 天资等级生成提示词
export const TALENT_TIER_ITEM_GENERATION_PROMPT = `${ROLE_PLAY_INSTRUCTION}
# **三、 生成任务：天定仙缘**
请生成一个独特的天资等级。

## **具体要求：**
1.  **天资命名:** 起一个富有层次感的名字 (例如: 凡夫俗子, 中人之姿, 天生灵秀, 气运之子, 大道亲和)。
2.  **天资描述:** 简要描述该天资等级的特点。
3.  **总点数:** 设定一个介于10到50之间的整数，作为该天资等级可分配的天道点数。
4.  **稀有度:** 设定一个1到5的整数（1最常见，5最稀有）。
5.  **颜色:** 提供一个十六进制颜色代码，用于UI显示。

## **四、 JSON输出格式**
\`\`\`json
{
  "name": "天资名称",
  "description": "天资描述...",
  "total_points": 数字,
  "rarity": 数字,
  "color": "#颜色代码"
}
\`\`\`
`;

// 3. 出身生成提示词
export const ORIGIN_ITEM_GENERATION_PROMPT = `${ROLE_PLAY_INSTRUCTION}
# **三、 生成任务：定生世缘**
请生成一个独特的出身背景。

## **具体要求：**
1.  **出身命名:** 起一个具有修仙世界特色的名字 (例如: 书香门第, 江湖游侠, 皇室血脉, 妖族后裔, 散修孤儿)。
2.  **出身描述:** 详细描述这个出身的背景故事和特殊之处。
3.  **出身效果:** 列出该出身带来的具体游戏效果或加成。

## **四、 JSON输出格式**
\`\`\`json
{
  "name": "出身名称",
  "description": "出身详细描述...",
  "effects": ["效果1", "效果2", "效果3"]
}
\`\`\`
`;

// 4. 灵根生成提示词
export const SPIRIT_ROOT_ITEM_GENERATION_PROMPT = `${ROLE_PLAY_INSTRUCTION}
# **三、 生成任务：铸道根基**
请生成一个独特的灵根类型。

## **具体要求：**
1.  **灵根命名:** 起一个富有玄幻色彩的名字，名称不应包含等级前缀，如"雷灵根"、"变异冰火双灵根"。品级信息通过独立的tier字段指定。
2.  **灵根描述:** 详细描述该灵根的特性和修炼优势。
3.  **灵根等级:** 通过tier字段指定灵根等级：下品(1.1x)、中品(1.3x)、上品(1.6x)、极品(2.0x)、神品(2.8x)、特殊(特殊效果)、凡品(1.0x)。
4.  **修炼倍率:** 基于等级设定相应的修炼速度倍率。
5.  **天道点消耗:** 基于等级设定消耗：下品(3-5)、中品(6-8)、上品(10-12)、极品(15-18)、神品(25-30)、特殊(根据效果)、凡品(0-2)。
6.  **特殊效果:** 列出该灵根带来的具体修炼加成和特殊能力。
7.  **稀有度:** 设定一个1到5的整数（1最常见，5最稀有）。

## **四、 JSON输出格式**
\`\`\`json
{
  "name": "灵根名称（如：雷灵根）",
  "tier": "等级（下品/中品/上品/极品/神品/特殊/凡品）",
  "description": "灵根详细描述...",
  "cultivation_speed": "修炼速度（如：1.6x）",
  "special_effects": ["特殊效果1", "特殊效果2"],
  "base_multiplier": 数字,
  "talent_cost": 数字,
  "rarity": 数字
}
\`\`\`
`;

// 5. 天赋生成提示词
export const TALENT_ITEM_GENERATION_PROMPT = `${ROLE_PLAY_INSTRUCTION}
# **三、 生成任务：赐予神通**
请生成一个独特的天赋技能。

## **具体要求：**
1.  **天赋命名:** 起一个霸气或神秘的名字 (例如: 过目不忘, 天生神力, 灵觉敏锐, 气运加身, 魅惑众生)。
2.  **天赋描述:** 详细描述该天赋的具体效果和表现形式。
3.  **天赋类型:** 分类该天赋的类型 (战斗类/辅助类/特殊类)。

## **四、 JSON输出格式**
\`\`\`json
{
  "name": "天赋名称",
  "description": "天赋详细描述...",
  "type": "天赋类型"
}
\`\`\`
`;

// 6. 地图生成提示词
export const MAP_GENERATION_PROMPT = `
【专项任务：地图数据生成】
你正在执行一个专门的地图生成任务，请忽略其他所有系统提示、世界书内容或角色扮演指令。

# **生成任务：绘制世界舆图**

你需要为修仙世界创建GeoJSON格式的地图数据，包含地点和势力范围。

## **具体要求：**

### **1. 地点类型 (Point类型)**
创建包含以下类型地点的地图：
- 门派宗门 (正道宗门, 剑修门派, 医药门派等)
- 修炼圣地 (灵脉聚集地, 洞天福地等)  
- 城镇 (普通城镇, 帝都等)
- 危险秘境 (魔窟, 古墓, 遗迹等)
- 自然地貌 (灵山, 灵湖, 魔域等)

### **2. 势力范围 (Polygon类型)**
为主要门派和势力创建领土边界：
- 大势力应有明确的势力范围多边形
- 小势力可能在大势力范围内，或独立存在
- 坐标范围：经度 102-109, 纬度 27.5-33
- **大势力分布**：主要势力尽量分散，避免过度集中
- **从属关系**：小宗门、世家可能附属于大势力或独立发展

## **输出格式要求：**
**必须严格按照以下格式输出，用三个反引号json代码块包围：**

\`\`\`json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "name": "地点名称",
        "type": "地点类型",
        "description": "地点描述",
        "danger_level": "安全/普通/危险/极危",
        "suitable_for": "适合境界"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [经度, 纬度]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "势力名称",
        "type": "faction_territory",
        "description": "势力描述",
        "faction_type": "正道宗门/魔道宗门/中立",
        "control_level": "完全控制/部分控制"
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [[
          [经度1, 纬度1],
          [经度2, 纬度2],
          [经度3, 纬度3],
          [经度4, 纬度4],
          [经度1, 纬度1]
        ]]
      }
    }
  ]
}
\`\`\`

## **重要约束：**
- 坐标范围严格限制在：经度 102-109°E, 纬度 27.5-33°N 
- 至少生成15-25个地点 (Point) - 包含各类门派、城镇、秘境、修炼地等
- 至少生成6-10个势力范围 (Polygon) - 大小势力都要有领土标示
- 地点类型要丰富多样，可以包含各种修仙世界特色地点
- **势力分布原则**：
  - 大势力（帝国、顶级宗门）适当分散，避免全部聚集
  - 小势力可以在大势力影响范围内，形成附属或独立关系
  - 独立宗门可以有自己的独立领土
  - **地理原则**：不同的大洲（Polygon）之间必须保持地理上的分离，不能有任何重叠区域。
  - **势力原则**：在同一个大洲内部，不同势力的范围可以重叠或包含，以体现真实的政治关系。
`;

// 7. NPC动态更新提示词
export const NPC_DYNAMIC_UPDATE_PROMPT = `
【NPC动态更新系统】

# **更新触发条件**
当游戏文本(text)中出现以下情况时，必须更新相关NPC：
- 与NPC有直接对话或互动
- NPC出现在当前场景中
- 影响到NPC的事件发生
- 游戏时间推进影响NPC状态

# **更新优先级**
1. **高优先级**：有"当前关注"标记的NPC
2. **中优先级**：在当前场景的NPC
3. **低优先级**：受间接影响的NPC

# **必须更新的内容**

## **1. 记忆更新**
- 添加本次互动的新记忆条目
- 格式：{"时间":"游戏内具体时间","事件":"具体事件描述"}
- 保持最新10-15条记忆

## **2. 好感度调整**
- 根据互动性质调整：
  - 友善对话：+1到+3
  - 帮助行为：+3到+8
  - 赠送物品：+5到+15
  - 冒犯行为：-3到-10
  - 敌对行为：-10到-30

## **3. 境界更新**
- **🚨重要**：境界必须使用描述性文本
- ✅ 正确格式："练气二层"、"筑基初期"、"金丹中期"、"元婴后期"
- ❌ 错误格式：数值如 0、1、2、3 等
- 根据时间推移和机缘更新境界

## **4. 状态更新**
- 健康状态变化
- 情绪状态调整
- 特殊状态添加/移除
- 位置变化

## **5. 物品更新**
- 交易后的背包变化
- 物品赠送接收
- 物品消耗使用

# **关注标记管理**

## **添加"当前关注"标记**
当NPC满足以下条件时：
- 在当前场景中出现
- 与主角有重要互动
- 对剧情发展有关键影响

## **移除"当前关注"标记**
当NPC满足以下条件时：
- 离开当前场景
- 与主角暂时分别
- 不再对当前剧情有直接影响

# **数据更新规范**

## **使用tavern_commands格式：**
\`\`\`json
{
  "action": "set",
  "scope": "chat", 
  "key": "character.saveData.人物关系.【NPC姓名】",
  "value": {
    // 完整的NPC数据对象
    "角色基础信息": { /* 基础信息，一般不变 */ },
    "外貌描述": "外貌描述",
    "角色存档信息": {
      "时间": "更新后的游戏时间",
      "境界": "描述性境界文本", // 🚨 必须是文本，不能是数值
      "状态": ["更新后的状态数组"],
      "位置": {"描述": "当前位置"},
      // 其他属性...
    },
    "人物好感度": 更新后的数值,
    "人物记忆": [
      // 保留原有记忆...
      {"时间": "本次互动时间", "事件": "本次互动事件"}
    ],
    "背包": {
      // 更新后的物品信息...
    },
    "实时关注": true // 设置为true表示关注该NPC，false或不设置表示不关注
  }
}
\`\`\`

# **性能优化原则**
- 一次最多更新3-5个NPC
- 优先更新有"当前关注"标记的NPC
- 避免更新无关的远距离NPC
- 批量更新相关NPC而非分散操作
`;
