# 《修士命格金册》v2.0 - 天道法典版

**源典：** 《大道朝天·AI交互完全参考书》
**用途：** 本文件是根据天道法典，为修士（玩家/NPC）定义的唯一、标准的动态数据结构，并规定了AI与系统交互的核心规范。

---

## 第一部分：角色完整数据结构 (源自法典第二章)

此结构是每一位修士在世界中存在的“数字道体”的完整定义。

```typescript
// 角色/NPC 完整数据结构 (Ultimate Version)
interface Character {
  // ==================== 基础信息 ====================
  identity: {
    name: string;                    // 姓名
    title?: string;                  // 称号，如"剑狂"、"毒手药王"
    age: number;                     // 实际年龄
    apparent_age: number;            // 外表年龄（修士驻颜）
    gender: string;                  // 性别
    description: string;             // 外貌描述
  };

  // ==================== 修为境界 ====================
  cultivation: {
    realm: string;                   // 当前境界，如"金丹后期"
    realm_progress: number;          // 境界进度 0-100
    lifespan_remaining: number;      // 剩余寿元（年）
    breakthrough_bottleneck?: string;// 突破瓶颈描述
  };

  // ==================== 六维根骨 ====================
  attributes: {
    STR: number;    // 力量 - 物理攻击、负重
    CON: number;    // 体质 - 生命、防御、抗性
    DEX: number;    // 身法 - 速度、闪避、精准
    INT: number;    // 悟性 - 学习速度、技艺成功率
    SPI: number;    // 神魂 - 法力、神识、法术威力
    LUK: number;    // 气运 - 影响一切随机事件
  };

  // ==================== 三大资源 ====================
  resources: {
    qi: { current: number; max: number };      // 气血
    ling: { current: number; max: number };    // 灵气
    shen: { current: number; max: number };    // 神识
  };

  // ==================== 天赋资质 ====================
  qualities: {
    origin: {
      name: string;        // 出身，如"书香门第"、"将门虎子"
      effects: string[];   // 出身带来的影响
    };
    spiritRoot: {
      name: string;        // 灵根类型，如"五行灵根"、"天道灵根"
      quality: string;     // 品质：废灵根/伪灵根/真灵根/天灵根/仙灵根
      attributes: string[];// 属性亲和，如["火", "雷"]
    };
    physique?: {
      name: string;        // 特殊体质，如"先天道体"、"九阴绝脉"
      effects: string[];   // 体质效果
    };
    talents: Array<{
      name: string;        // 天赋名称
      type: string;        // 类型：战斗/修炼/技艺/特殊
      effects: string[];   // 具体效果
    }>;
  };

  // ==================== 修仙百艺 ====================
  skills: {
    combat: { level: number; specialties: string[]; };
    alchemy: { level: number; rank: string; known_recipes: string[]; success_rate: number; };
    crafting: { level: number; rank: string; specialization: string; };
    formation: { level: number; rank: string; known_formations: string[]; };
    talisman: { level: number; rank: string; drawing_speed: number; };
    beast_taming: { level: number; max_contracts: number; affinity: string[]; };
  };

  // ==================== 功法装备 ====================
  cultivation_arts: {
    main_technique: { name: string; rank: string; proficiency: number; special_effects: string[]; };
    combat_techniques: Array<{ name: string; type: string; cost: number; cooldown: number; }>;
    auxiliary_techniques: string[];
  };
  equipment: {
    weapon?: any; // 应为Item类型
    armor?: any; // 应为Item类型
    accessories: any[];
    treasures: any[];
    consumables: any[];
  };

  // ==================== 社交关系 ====================
  social: {
    faction?: string;
    position?: string;
    master?: string;
    disciples?: string[];
    dao_companion?: string;
    relationships: Record<string, { value: number; type: string; }>;
    reputation: Record<string, number>;
  };

  // ==================== 隐藏状态 ====================
  hidden_state: {
    karma: { righteous: number; demonic: number; heavenly_favor: number; };
    dao_heart: { stability: number; demons: string[]; enlightenment: number; };
    special_marks: string[];
  };

  // ==================== 当前状态 ====================
  status: {
    conditions: string[];
    location: string;
    activity: string;
    mood: string;
  };
}
```

---

## 第二部分：AI请求响应规范 (源自法典第七章)

此规范定义了前端/系统与天机AI之间进行信息交换的唯一标准格式。

### 1. 标准请求格式 (系统 -> AI)

```json
{
  "type": "DAO_ACTION",
  "context": {
    "world": {
      "location": "青云宗·外门",
      "ring_level": 4,
      "spiritual_density": 0.5,
      "current_time": "辰时",
      "weather": "晴",
      "special_events": []
    },
    "character": "/* 此处应填入上述完整的Character数据结构 */",
    "npcs_present": [
      {
        "name": "王长老",
        "realm": "筑基后期",
        "relationship": 45,
        "current_mood": "平静"
      }
    ],
    "difficulty": {
      "level": "CULTIVATOR",
      "reality_check_enabled": true
    }
  },
  "user_input": "我想向王长老请教炼丹之道",
  "ai_instructions": [
    "【天条】严格遵守世界规则，不可违背因果逻辑",
    "【天条】NPC有独立人格，不会无缘无故帮助玩家"
  ]
}
```

### 2. 标准响应格式 (AI -> 系统)

```json
{
  "narrative": {
    "text": "王长老抬眼看了你一眼，淡淡道：'炼丹之道，非一日之功...'",
    "tone": "neutral",
    "keywords": ["炼丹", "任务", "百年灵草"]
  },
  "environment": {
    "visual": "丹房内药香四溢...",
    "audio": "丹炉中传来轻微的嗡鸣声...",
    "atmosphere": "严肃而神秘"
  },
  "updates": {
    "quests": [
      {
        "id": "wang_elder_herbs",
        "name": "王长老的考验",
        "description": "为王长老寻找三株百年灵草",
        "objectives": ["百年灵草 0/3"],
        "rewards": ["炼丹指导", "好感度+20", "基础丹方"]
      }
    ],
    "relationships": {
      "王长老": { "change": 5, "current": 50 }
    },
    "knowledge_gained": [
      "了解到炼丹需要强大的神识控制"
    ]
  },
  "options": [
    "接受任务，询问哪里能找到百年灵草",
    "询问是否有其他获得指导的方式",
    "告辞离开"
  ],
  "system_log": {
    "checks_passed": [
      "NPC反应合理性: ✓ 筑基期长老不会轻易教导炼气期弟子"
    ],
    "difficulty_modifiers": {
      "task_difficulty": "适中"
    }
  }
}